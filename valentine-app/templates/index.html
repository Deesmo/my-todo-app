<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Happy Valentine's Day Katy ❤️</title>
<meta name="theme-color" content="#1a0a1e">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="For Katy ❤️">
<link rel="manifest" href="/static/manifest.json">
<link rel="icon" type="image/x-icon" href="/static/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
<style>
  :root {
    --love-deep: #8b0a3a;
    --love-bright: #e91e63;
    --love-pink: #f48fb1;
    --love-soft: #fce4ec;
    --gold: #ffd700;
    --gold-glow: rgba(255,215,0,.3);
    --glass: rgba(255,255,255,.1);
    --glass-border: rgba(255,255,255,.15);
    --glass-strong: rgba(255,255,255,.15);
    --text: #fff5f8;
    --text-secondary: rgba(255,245,248,.75);
    --text-muted: rgba(255,245,248,.5);
    --radius: 20px;
    --radius-sm: 14px;
    --blur: blur(20px);
    --transition: .3s cubic-bezier(.4,0,.2,1);
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Georgia", serif;
    min-height: 100vh; min-height: 100dvh;
    color: var(--text);
    background: #1a0a1e;
    background: linear-gradient(160deg, #1a0a1e 0%, #2d0a2e 20%, #3d0f3a 40%, #4a1042 55%, #2d0a2e 75%, #1a0a1e 100%);
    background-attachment: fixed;
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
    user-select: none; -webkit-user-select: none;
  }

  /* Ambient glow orbs */
  body::before, body::after {
    content: ""; position: fixed; border-radius: 50%; pointer-events: none; z-index: 0;
    filter: blur(100px); opacity: .5;
  }
  body::before {
    width: 500px; height: 500px; top: -150px; right: -150px;
    background: radial-gradient(circle, rgba(233,30,99,.5), transparent 70%);
    animation: orbFloat 18s ease-in-out infinite alternate;
  }
  body::after {
    width: 450px; height: 450px; bottom: -120px; left: -120px;
    background: radial-gradient(circle, rgba(244,143,177,.4), transparent 70%);
    animation: orbFloat 22s ease-in-out infinite alternate-reverse;
  }
  @keyframes orbFloat {
    0% { transform: translate(0,0) scale(1); }
    50% { transform: translate(40px,-30px) scale(1.15); }
    100% { transform: translate(-30px,40px) scale(.9); }
  }

  /* Floating hearts */
  .hearts-container {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 0; overflow: hidden;
  }
  .heart {
    position: absolute; bottom: -60px;
    font-size: 20px; opacity: 0;
    animation: floatHeart linear infinite;
  }
  @keyframes floatHeart {
    0% { opacity: 0; transform: translateY(0) rotate(0deg) scale(.5); }
    10% { opacity: .7; }
    60% { opacity: .5; }
    100% { opacity: 0; transform: translateY(-105vh) rotate(720deg) scale(1.2); }
  }

  .container {
    max-width: 600px; margin: 0 auto;
    padding: calc(24px + env(safe-area-inset-top)) 16px calc(40px + env(safe-area-inset-bottom));
    position: relative; z-index: 1;
  }

  /* Header */
  .header {
    text-align: center; margin-bottom: 20px; padding: 10px 0;
  }
  .header-heart {
    font-size: 3rem; margin-bottom: 8px;
    display: inline-block;
    animation: heartbeat 1.2s ease-in-out infinite;
    filter: drop-shadow(0 0 20px rgba(233,30,99,.6));
  }
  @keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    15% { transform: scale(1.15); }
    30% { transform: scale(1); }
    45% { transform: scale(1.1); }
  }
  .header-title {
    font-size: 1.8rem; font-weight: 700;
    background: linear-gradient(135deg, #fff, var(--love-pink), var(--gold));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.3; letter-spacing: -.01em;
  }
  .header-subtitle {
    font-size: .95rem; color: var(--text-secondary);
    margin-top: 6px; font-style: italic;
    font-family: Georgia, "Times New Roman", serif;
  }

  /* Navigation tabs */
  .nav-tabs {
    display: flex; gap: 4px;
    margin-bottom: 24px; padding: 4px;
    background: var(--glass);
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    overflow-x: auto; -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  .nav-tabs::-webkit-scrollbar { display: none; }
  .nav-tab {
    flex: 0 0 auto; padding: 10px 14px; border: none; border-radius: 12px;
    background: transparent; color: var(--text-muted);
    font-size: .78rem; font-weight: 600; cursor: pointer;
    transition: var(--transition);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    -webkit-tap-highlight-color: transparent;
    white-space: nowrap;
  }
  .nav-tab.active {
    background: linear-gradient(135deg, rgba(233,30,99,.4), rgba(244,143,177,.3));
    color: #fff;
    box-shadow: 0 2px 12px rgba(233,30,99,.3);
  }
  .nav-tab:not(.active):hover { color: var(--text-secondary); }

  /* Page sections */
  .page { display: none; }
  .page.active { display: block; animation: fadeInUp .5s ease forwards; }

  /* Glass panel */
  .glass {
    background: var(--glass);
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    box-shadow: 0 8px 32px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.08);
  }

  /* Photo gallery */
  .gallery-section { margin-bottom: 28px; }
  .gallery-label {
    text-align: center; font-size: .8rem; color: var(--text-muted);
    margin-bottom: 10px; letter-spacing: .05em; text-transform: uppercase;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  .gallery {
    position: relative; overflow: hidden; border-radius: var(--radius);
    aspect-ratio: 4/5;
    background: rgba(0,0,0,.3);
    border: 1px solid var(--glass-border);
    box-shadow: 0 12px 40px rgba(0,0,0,.3), inset 0 1px 0 rgba(255,255,255,.05);
    touch-action: pan-y pinch-zoom;
  }
  .gallery-track {
    display: flex; height: 100%;
    transition: transform .4s cubic-bezier(.25,.46,.45,.94);
    will-change: transform;
  }
  .gallery-track.dragging { transition: none; }
  .gallery-slide {
    min-width: 100%; height: 100%;
    display: flex; align-items: center; justify-content: center;
    overflow: hidden;
  }
  .gallery-slide img {
    width: 100%; height: 100%; object-fit: cover;
  }

  /* Gallery dots */
  .gallery-dots {
    display: flex; justify-content: center; gap: 8px;
    margin-top: 14px;
  }
  .gallery-dot {
    width: 8px; height: 8px; border-radius: 50%;
    background: rgba(255,255,255,.25);
    transition: var(--transition);
    cursor: pointer;
  }
  .gallery-dot.active {
    background: var(--love-pink);
    box-shadow: 0 0 10px rgba(233,30,99,.5);
    transform: scale(1.3);
  }

  /* Gallery arrows */
  .gallery-arrow {
    position: absolute; top: 50%; transform: translateY(-50%);
    width: 40px; height: 40px; border-radius: 50%;
    background: rgba(0,0,0,.4); backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,.15);
    color: #fff; font-size: 1.1rem; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: var(--transition); z-index: 2;
    -webkit-tap-highlight-color: transparent;
  }
  .gallery-arrow:hover { background: rgba(0,0,0,.6); }
  .gallery-arrow.prev { left: 10px; }
  .gallery-arrow.next { right: 10px; }

  /* Music player */
  .music-section { margin-bottom: 28px; }
  .music-player {
    padding: 20px; display: flex; align-items: center; gap: 16px;
  }
  .music-btn {
    width: 56px; height: 56px; border-radius: 50%; border: none; cursor: pointer;
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    color: #fff; font-size: 1.4rem;
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 4px 20px rgba(233,30,99,.5);
    transition: var(--transition); flex-shrink: 0;
    -webkit-tap-highlight-color: transparent;
  }
  .music-btn:hover { transform: scale(1.08); box-shadow: 0 6px 28px rgba(233,30,99,.6); }
  .music-btn:active { transform: scale(.95); }
  .music-btn.playing {
    animation: pulseGlow 2s ease-in-out infinite;
  }
  @keyframes pulseGlow {
    0%, 100% { box-shadow: 0 4px 20px rgba(233,30,99,.5); }
    50% { box-shadow: 0 4px 30px rgba(233,30,99,.8), 0 0 40px rgba(233,30,99,.3); }
  }
  .music-info { flex: 1; min-width: 0; }
  .music-title {
    font-size: 1rem; font-weight: 600; color: var(--text);
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .music-artist {
    font-size: .82rem; color: var(--text-secondary); margin-top: 2px;
  }
  .music-progress {
    margin-top: 10px; height: 3px; border-radius: 3px;
    background: rgba(255,255,255,.12); overflow: hidden;
    cursor: pointer;
  }
  .music-progress-fill {
    height: 100%; border-radius: 3px;
    background: linear-gradient(90deg, var(--love-bright), var(--love-pink));
    transition: width .3s linear; width: 0%;
  }
  .music-note {
    display: inline-block; font-size: .8rem;
    opacity: 0; transition: opacity .3s;
  }
  .music-btn.playing ~ .music-info .music-note { opacity: 1; }
  .music-time {
    font-size: .72rem; color: var(--text-muted); margin-top: 4px;
    display: flex; justify-content: space-between;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }

  /* Visualizer bars */
  .visualizer {
    display: flex; align-items: flex-end; gap: 2px; height: 20px;
    margin-left: auto; padding-left: 12px;
  }
  .viz-bar {
    width: 3px; border-radius: 2px;
    background: linear-gradient(to top, var(--love-bright), var(--love-pink));
    transition: height .15s ease;
  }
  .viz-bar:nth-child(1) { height: 4px; animation: vizBounce .5s ease-in-out infinite alternate; }
  .viz-bar:nth-child(2) { height: 8px; animation: vizBounce .4s ease-in-out infinite alternate .1s; }
  .viz-bar:nth-child(3) { height: 14px; animation: vizBounce .6s ease-in-out infinite alternate .05s; }
  .viz-bar:nth-child(4) { height: 10px; animation: vizBounce .45s ease-in-out infinite alternate .15s; }
  .viz-bar:nth-child(5) { height: 6px; animation: vizBounce .55s ease-in-out infinite alternate .08s; }
  .visualizer.paused .viz-bar { animation-play-state: paused; height: 3px !important; }
  @keyframes vizBounce {
    0% { height: 3px; }
    100% { height: 18px; }
  }

  /* Skip button */
  .skip-btn {
    width: 40px; height: 40px; border-radius: 50%; border: none;
    background: rgba(255,255,255,.08);
    color: #fff; cursor: pointer; flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
    transition: var(--transition);
    -webkit-tap-highlight-color: transparent;
  }
  .skip-btn:hover { background: rgba(255,255,255,.15); }
  .skip-btn:active { transform: scale(.88); }

  /* Love message */
  .message-section { margin-bottom: 28px; }
  .love-message {
    padding: 28px 24px; text-align: center;
    background: linear-gradient(135deg, rgba(233,30,99,.12), rgba(244,143,177,.08));
    border: 1px solid rgba(233,30,99,.2);
  }
  .message-icon { font-size: 2.4rem; margin-bottom: 14px; display: block; }
  .message-text {
    font-size: 1.05rem; line-height: 1.75;
    font-family: Georgia, "Times New Roman", serif;
    color: var(--text);
    letter-spacing: .01em;
  }
  .message-signature {
    margin-top: 20px; font-size: .9rem;
    color: var(--love-pink); font-style: italic;
    font-family: Georgia, "Times New Roman", serif;
  }

  /* Valentine decoration divider */
  .divider {
    text-align: center; margin: 8px 0;
    font-size: .75rem; color: var(--text-muted);
    letter-spacing: 6px;
  }

  /* Footer */
  .footer {
    text-align: center; padding: 20px 0 10px;
    font-size: .75rem; color: var(--text-muted);
    font-family: Georgia, "Times New Roman", serif;
    font-style: italic;
  }

  /* ── Poems section ── */
  .poem-viewer {
    position: relative; overflow: hidden;
    border-radius: var(--radius);
    background: linear-gradient(135deg, rgba(233,30,99,.08), rgba(139,10,58,.06));
    border: 1px solid rgba(233,30,99,.18);
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
    box-shadow: 0 8px 32px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.08);
    min-height: 420px;
    touch-action: pan-y pinch-zoom;
  }
  .poem-track {
    display: flex;
    transition: transform .45s cubic-bezier(.25,.46,.45,.94);
    will-change: transform;
  }
  .poem-track.dragging { transition: none; }
  .poem-page {
    min-width: 100%;
    padding: 32px 24px;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    text-align: center;
  }
  .poem-number {
    font-size: .7rem; text-transform: uppercase; letter-spacing: .12em;
    color: var(--text-muted); margin-bottom: 16px;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  .poem-title {
    font-size: 1.3rem; font-weight: 700;
    color: var(--love-pink); margin-bottom: 6px;
    font-family: Georgia, "Times New Roman", serif;
    line-height: 1.3;
  }
  .poem-author {
    font-size: .82rem; color: var(--text-muted);
    font-style: italic; margin-bottom: 24px;
    font-family: Georgia, "Times New Roman", serif;
  }
  .poem-body {
    font-family: Georgia, "Times New Roman", serif;
    font-size: .95rem; line-height: 1.85;
    color: var(--text-secondary);
    white-space: pre-line;
    max-width: 380px;
  }
  .poem-body .stanza { margin-bottom: 16px; display: block; }
  .poem-body .stanza:last-child { margin-bottom: 0; }

  /* Poem navigation */
  .poem-nav {
    display: flex; align-items: center; justify-content: center;
    gap: 16px; margin-top: 18px;
  }
  .poem-arrow {
    width: 40px; height: 40px; border-radius: 50%;
    background: var(--glass);
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
    border: 1px solid var(--glass-border);
    color: #fff; font-size: 1.1rem; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: var(--transition);
    -webkit-tap-highlight-color: transparent;
  }
  .poem-arrow:hover { background: rgba(255,255,255,.18); }
  .poem-arrow:active { transform: scale(.92); }
  .poem-arrow:disabled { opacity: .3; pointer-events: none; }
  .poem-counter {
    font-size: .8rem; color: var(--text-muted);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    min-width: 50px; text-align: center;
  }

  /* Poem dots */
  .poem-dots {
    display: flex; justify-content: center; gap: 6px;
    margin-top: 12px; flex-wrap: wrap;
  }
  .poem-dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: rgba(255,255,255,.2);
    transition: var(--transition);
    cursor: pointer;
  }
  .poem-dot.active {
    background: var(--love-pink);
    box-shadow: 0 0 8px rgba(233,30,99,.4);
    transform: scale(1.4);
  }

  /* Tap-to-play overlay */
  .tap-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(10,5,15,.85);
    backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
    z-index: 9999; display: flex; align-items: center; justify-content: center;
    cursor: pointer; -webkit-tap-highlight-color: transparent;
    transition: opacity .6s ease, visibility .6s ease;
  }
  .tap-overlay.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
  .tap-content { text-align: center; }
  .tap-heart {
    font-size: 5rem; margin-bottom: 16px;
    animation: heartbeat 1.2s ease-in-out infinite;
    filter: drop-shadow(0 0 30px rgba(233,30,99,.6));
  }
  .tap-text {
    font-size: 1.3rem; font-weight: 600; color: #fff;
    margin-bottom: 8px; letter-spacing: .02em;
  }
  .tap-sub {
    font-size: .9rem; color: var(--love-pink);
    font-family: Georgia, "Times New Roman", serif;
    font-style: italic;
  }

  /* Animations */
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .fade-in {
    opacity: 0;
    animation: fadeInUp .8s cubic-bezier(.4,0,.2,1) forwards;
  }
  .fade-in-1 { animation-delay: .1s; }
  .fade-in-2 { animation-delay: .3s; }
  .fade-in-3 { animation-delay: .5s; }
  .fade-in-4 { animation-delay: .7s; }

  /* Sparkle overlay on gallery */
  .sparkle-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 1;
    background: radial-gradient(ellipse at 30% 20%, rgba(255,215,0,.08) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(255,255,255,.05) 0%, transparent 50%);
  }

  /* ── Coupons section ── */
  .coupon-card {
    display: flex; align-items: center; gap: 16px;
    padding: 20px; margin-bottom: 14px;
    cursor: pointer;
    transition: var(--transition);
    position: relative; overflow: hidden;
    -webkit-tap-highlight-color: transparent;
  }
  .coupon-card:active { transform: scale(.97); }
  .coupon-check {
    width: 36px; height: 36px; border-radius: 50%; flex-shrink: 0;
    border: 2px solid var(--love-pink);
    display: flex; align-items: center; justify-content: center;
    transition: var(--transition);
    color: transparent;
  }
  .coupon-check svg { width: 20px; height: 20px; }
  .coupon-card.redeemed .coupon-check {
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    border-color: var(--love-bright);
    color: #fff;
  }
  .coupon-body { flex: 1; min-width: 0; }
  .coupon-emoji { font-size: 1.6rem; margin-bottom: 4px; }
  .coupon-title {
    font-size: 1rem; font-weight: 700; color: var(--text);
    line-height: 1.3; margin-bottom: 4px;
  }
  .coupon-desc {
    font-size: .82rem; color: var(--text-secondary);
    line-height: 1.5;
    font-family: Georgia, "Times New Roman", serif;
  }
  .coupon-redeemed-badge {
    position: absolute; top: 12px; right: -32px;
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    color: #fff; font-size: .65rem; font-weight: 700;
    padding: 4px 36px;
    transform: rotate(35deg);
    text-transform: uppercase; letter-spacing: .06em;
    opacity: 0; transition: opacity .3s ease;
    pointer-events: none;
  }
  .coupon-card.redeemed .coupon-redeemed-badge { opacity: 1; }
  .coupon-card.redeemed .coupon-title {
    text-decoration: line-through;
    color: var(--text-muted);
  }
  .coupon-card.redeemed .coupon-desc {
    color: var(--text-muted);
  }
  .coupon-fine-print {
    text-align: center; font-size: .72rem;
    color: var(--text-muted); margin-top: 8px;
    font-family: Georgia, "Times New Roman", serif;
    font-style: italic;
  }

  /* ── Scavenger Hunt section ── */
  .hunt-intro {
    text-align: center; padding: 24px 20px; margin-bottom: 16px;
    background: linear-gradient(135deg, rgba(233,30,99,.10), rgba(255,215,0,.06));
    border: 1px solid rgba(233,30,99,.18);
  }
  .hunt-intro-icon { font-size: 2.2rem; margin-bottom: 10px; display: block; }
  .hunt-intro-text {
    font-size: .92rem; line-height: 1.7; color: var(--text-secondary);
    font-family: Georgia, "Times New Roman", serif;
  }
  .hunt-progress {
    text-align: center; margin-bottom: 18px;
    font-size: .78rem; color: var(--text-muted);
    letter-spacing: .05em; text-transform: uppercase;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  .hunt-progress-bar {
    height: 4px; border-radius: 4px; margin: 8px auto 0;
    max-width: 240px;
    background: rgba(255,255,255,.08);
    overflow: hidden;
  }
  .hunt-progress-fill {
    height: 100%; border-radius: 4px;
    background: linear-gradient(90deg, var(--love-bright), var(--gold));
    transition: width .5s cubic-bezier(.4,0,.2,1);
    width: 0%;
  }
  .hunt-clue {
    display: flex; align-items: flex-start; gap: 14px;
    padding: 18px; margin-bottom: 12px;
    cursor: pointer;
    transition: var(--transition);
    position: relative; overflow: hidden;
    -webkit-tap-highlight-color: transparent;
  }
  .hunt-clue.locked {
    opacity: .35; pointer-events: none;
    filter: blur(1px);
  }
  .hunt-clue.locked .hunt-clue-text {
    -webkit-user-select: none; user-select: none;
  }
  .hunt-clue:not(.locked):active { transform: scale(.97); }
  .hunt-clue-check {
    width: 32px; height: 32px; border-radius: 50%; flex-shrink: 0;
    border: 2px solid var(--gold);
    display: flex; align-items: center; justify-content: center;
    transition: var(--transition);
    color: transparent; margin-top: 2px;
  }
  .hunt-clue-check svg { width: 18px; height: 18px; }
  .hunt-clue.solved .hunt-clue-check {
    background: linear-gradient(135deg, var(--gold), #ffb300);
    border-color: var(--gold);
    color: #1a0a1e;
    box-shadow: 0 0 12px var(--gold-glow);
  }
  .hunt-clue-body { flex: 1; min-width: 0; }
  .hunt-clue-number {
    font-size: .7rem; text-transform: uppercase; letter-spacing: .1em;
    color: var(--gold); margin-bottom: 6px;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    font-weight: 600;
  }
  .hunt-clue.solved .hunt-clue-number { color: var(--text-muted); }
  .hunt-clue-text {
    font-size: .88rem; line-height: 1.7; color: var(--text);
    font-family: Georgia, "Times New Roman", serif;
    font-style: italic;
  }
  .hunt-clue.solved .hunt-clue-text {
    color: var(--text-muted);
  }
  .hunt-clue-lock {
    font-size: 1.1rem; margin-top: 2px; flex-shrink: 0;
  }
  .hunt-complete {
    text-align: center; padding: 28px 20px; margin-top: 4px;
    background: linear-gradient(135deg, rgba(255,215,0,.12), rgba(233,30,99,.08));
    border: 1px solid rgba(255,215,0,.25);
    display: none;
  }
  .hunt-complete.visible { display: block; animation: fadeInUp .6s ease forwards; }
  .hunt-complete-icon { font-size: 2.8rem; margin-bottom: 12px; display: block; }
  .hunt-complete-title {
    font-size: 1.15rem; font-weight: 700; color: var(--gold);
    margin-bottom: 8px;
    font-family: Georgia, "Times New Roman", serif;
  }
  .hunt-complete-text {
    font-size: .95rem; color: var(--text-secondary); line-height: 1.6;
    font-family: Georgia, "Times New Roman", serif;
  }

  /* Touch feedback */
  @media (hover: none) {
    .gallery-arrow { width: 36px; height: 36px; font-size: 1rem; }
    .music-btn:hover { transform: none; }
    .music-btn:active { transform: scale(.92); }
  }
  @media (max-width: 480px) {
    .container { padding: calc(16px + env(safe-area-inset-top)) 12px calc(30px + env(safe-area-inset-bottom)); }
    .header-title { font-size: 1.5rem; }
    .love-message { padding: 22px 18px; }
    .message-text { font-size: .95rem; }
    .music-player { padding: 16px; gap: 12px; }
    .music-btn { width: 48px; height: 48px; font-size: 1.2rem; }
    .poem-page { padding: 24px 16px; }
    .poem-title { font-size: 1.15rem; }
    .poem-body { font-size: .88rem; }
  }

  /* ── Daily Reminder popup ── */
  .daily-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(10,5,15,.8);
    backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
    z-index: 9998; display: flex; align-items: center; justify-content: center;
    padding: 24px;
    opacity: 0; visibility: hidden;
    transition: opacity .5s ease, visibility .5s ease;
  }
  .daily-overlay.visible { opacity: 1; visibility: visible; }
  .daily-card {
    max-width: 360px; width: 100%; padding: 36px 28px;
    text-align: center;
    background: linear-gradient(135deg, rgba(233,30,99,.15), rgba(244,143,177,.08));
    border: 1px solid rgba(233,30,99,.25);
    border-radius: var(--radius);
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
    box-shadow: 0 16px 48px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.1);
    animation: fadeInUp .6s ease .2s both;
  }
  .daily-icon { font-size: 3rem; margin-bottom: 16px; display: block; }
  .daily-text {
    font-size: 1.1rem; line-height: 1.8; color: var(--text);
    font-family: Georgia, "Times New Roman", serif;
    font-style: italic;
  }
  .daily-dismiss {
    margin-top: 24px; padding: 12px 32px;
    border: 1px solid rgba(233,30,99,.3); border-radius: 30px;
    background: linear-gradient(135deg, rgba(233,30,99,.25), rgba(244,143,177,.15));
    color: var(--love-pink); font-size: .88rem; font-weight: 600;
    cursor: pointer; transition: var(--transition);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    -webkit-tap-highlight-color: transparent;
  }
  .daily-dismiss:hover { background: linear-gradient(135deg, rgba(233,30,99,.35), rgba(244,143,177,.25)); }
  .daily-dismiss:active { transform: scale(.95); }

  /* ── You Fascinate Me video section ── */
  .video-section { margin-bottom: 28px; }
  .video-container {
    position: relative; overflow: hidden;
    border-radius: var(--radius);
    background: rgba(0,0,0,.4);
    border: 1px solid var(--glass-border);
    box-shadow: 0 12px 40px rgba(0,0,0,.3), inset 0 1px 0 rgba(255,255,255,.05);
  }
  .video-container video {
    width: 100%; display: block; border-radius: var(--radius);
  }
  .video-play-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    display: flex; align-items: center; justify-content: center;
    background: rgba(0,0,0,.3);
    cursor: pointer; z-index: 2;
    transition: opacity .3s ease;
    -webkit-tap-highlight-color: transparent;
  }
  .video-play-overlay.hidden { opacity: 0; pointer-events: none; }
  .video-play-btn {
    width: 72px; height: 72px; border-radius: 50%;
    background: linear-gradient(135deg, rgba(233,30,99,.8), rgba(194,24,91,.8));
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255,255,255,.2);
    display: flex; align-items: center; justify-content: center;
    transition: var(--transition);
    box-shadow: 0 8px 32px rgba(233,30,99,.4);
  }
  .video-play-overlay:active .video-play-btn { transform: scale(.9); }
  .video-play-btn svg { margin-left: 4px; }
  .video-quote {
    text-align: center; padding: 24px 20px; margin-top: 16px;
    background: linear-gradient(135deg, rgba(233,30,99,.10), rgba(244,143,177,.06));
    border: 1px solid rgba(233,30,99,.18);
  }
  .video-quote-text {
    font-size: 1rem; line-height: 1.7; color: var(--text);
    font-family: Georgia, "Times New Roman", serif;
    font-style: italic;
  }
  .video-quote-attr {
    margin-top: 10px; font-size: .82rem; color: var(--text-muted);
    font-family: Georgia, "Times New Roman", serif;
  }

  /* ── Generator shared styles ── */
  .gen-card {
    padding: 32px 24px; text-align: center;
    min-height: 280px;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    position: relative; overflow: hidden;
  }
  .gen-card-inner {
    transition: opacity .35s ease, transform .35s ease;
  }
  .gen-card-inner.switching {
    opacity: 0; transform: translateY(20px) scale(.96);
  }
  .gen-category {
    display: inline-block; padding: 4px 14px;
    border-radius: 20px; font-size: .7rem;
    font-weight: 700; letter-spacing: .08em;
    text-transform: uppercase; margin-bottom: 16px;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  .gen-category.romantic { background: rgba(233,30,99,.25); color: #f48fb1; }
  .gen-category.adventurous { background: rgba(255,152,0,.2); color: #ffb74d; }
  .gen-category.cozy { background: rgba(156,39,176,.2); color: #ce93d8; }
  .gen-category.fancy { background: rgba(255,215,0,.2); color: #ffd700; }
  .gen-category.fun { background: rgba(0,188,212,.2); color: #4dd0e1; }
  .gen-category.athome { background: rgba(139,195,74,.2); color: #aed581; }
  .gen-category.quick { background: rgba(76,175,80,.2); color: #81c784; }
  .gen-category.comfort { background: rgba(255,138,101,.2); color: #ffab91; }
  .gen-category.healthy { background: rgba(102,187,106,.2); color: #a5d6a7; }
  .gen-category.takeout { background: rgba(255,183,77,.2); color: #ffe082; }
  .gen-category.sweet { background: rgba(244,143,177,.25); color: #f8bbd0; }
  .gen-category.sexy { background: rgba(233,30,99,.3); color: #f06292; }
  .gen-category.funny { background: rgba(0,188,212,.25); color: #80deea; }
  .gen-icon { font-size: 2.8rem; margin-bottom: 16px; display: block; }
  .gen-title {
    font-size: 1.35rem; font-weight: 700; color: var(--text);
    margin-bottom: 10px; line-height: 1.3;
    font-family: Georgia, "Times New Roman", serif;
  }
  .gen-desc {
    font-size: .92rem; line-height: 1.7; color: var(--text-secondary);
    font-family: Georgia, "Times New Roman", serif;
    max-width: 340px;
  }
  .gen-meta {
    margin-top: 14px; font-size: .78rem; color: var(--text-muted);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    letter-spacing: .03em;
  }
  .gen-btn {
    margin-top: 24px; padding: 14px 36px;
    border: none; border-radius: 30px;
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    color: #fff; font-size: .95rem; font-weight: 700;
    cursor: pointer; transition: var(--transition);
    box-shadow: 0 4px 20px rgba(233,30,99,.4);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    -webkit-tap-highlight-color: transparent;
    letter-spacing: .02em;
  }
  .gen-btn:hover { transform: scale(1.05); box-shadow: 0 6px 28px rgba(233,30,99,.5); }
  .gen-btn:active { transform: scale(.95); }

  /* Compliment specific */
  .compliment-text {
    font-size: 1.25rem; line-height: 1.8; color: var(--text);
    font-family: Georgia, "Times New Roman", serif;
    font-style: italic; max-width: 360px;
    transition: opacity .35s ease, transform .35s ease;
  }
  .compliment-text.switching {
    opacity: 0; transform: translateY(20px) scale(.96);
  }
  .compliment-burst {
    position: absolute; pointer-events: none;
    font-size: 1.2rem; opacity: 0;
    animation: burstHeart .8s ease-out forwards;
  }
  @keyframes burstHeart {
    0% { opacity: 1; transform: translate(0,0) scale(.5); }
    100% { opacity: 0; transform: translate(var(--bx), var(--by)) scale(1.3); }
  }
  @media (max-width: 480px) {
    .gen-card { padding: 24px 16px; min-height: 240px; }
    .gen-title { font-size: 1.15rem; }
    .gen-desc { font-size: .85rem; }
    .compliment-text { font-size: 1.1rem; }
  }

  /* ── Photo Booth ── */
  .booth-viewfinder {
    position: relative; overflow: hidden;
    border-radius: var(--radius);
    background: rgba(0,0,0,.6);
    aspect-ratio: 3/4;
    border: 1px solid var(--glass-border);
    box-shadow: 0 12px 40px rgba(0,0,0,.3);
  }
  .booth-viewfinder video,
  .booth-viewfinder canvas {
    width: 100%; height: 100%; object-fit: cover;
    border-radius: var(--radius); display: block;
  }
  .booth-viewfinder canvas { display: none; }
  .booth-viewfinder.captured video { display: none; }
  .booth-viewfinder.captured canvas { display: block; }
  .booth-frame-overlay {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 2;
    border-radius: var(--radius);
  }
  .booth-controls {
    display: flex; justify-content: center; gap: 14px;
    margin-top: 18px; flex-wrap: wrap;
  }
  .booth-snap {
    width: 68px; height: 68px; border-radius: 50%; border: 4px solid #fff;
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    cursor: pointer; transition: var(--transition);
    box-shadow: 0 4px 20px rgba(233,30,99,.5);
    display: flex; align-items: center; justify-content: center;
    -webkit-tap-highlight-color: transparent;
  }
  .booth-snap:active { transform: scale(.88); }
  .booth-snap svg { pointer-events: none; }
  .booth-action {
    padding: 10px 20px; border: 1px solid var(--glass-border);
    border-radius: 30px; background: var(--glass);
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
    color: var(--text); font-size: .82rem; font-weight: 600;
    cursor: pointer; transition: var(--transition);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    -webkit-tap-highlight-color: transparent;
  }
  .booth-action:active { transform: scale(.93); }
  .booth-frames {
    display: flex; gap: 8px; justify-content: center;
    margin-top: 14px; flex-wrap: wrap;
  }
  .booth-frame-opt {
    padding: 8px 14px; border-radius: 20px; font-size: .75rem;
    font-weight: 600; cursor: pointer; transition: var(--transition);
    border: 1px solid var(--glass-border); background: var(--glass);
    color: var(--text-muted);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    -webkit-tap-highlight-color: transparent;
  }
  .booth-frame-opt.active {
    background: linear-gradient(135deg, rgba(233,30,99,.4), rgba(244,143,177,.3));
    color: #fff; border-color: rgba(233,30,99,.4);
  }

  /* ── Text Me When ── */
  .sms-card {
    display: flex; align-items: center; gap: 14px;
    padding: 18px; margin-bottom: 12px;
    cursor: pointer; transition: var(--transition);
    text-decoration: none;
    -webkit-tap-highlight-color: transparent;
  }
  .sms-card:active { transform: scale(.97); }
  .sms-emoji { font-size: 2rem; flex-shrink: 0; }
  .sms-body { flex: 1; min-width: 0; }
  .sms-label {
    font-size: .72rem; text-transform: uppercase; letter-spacing: .08em;
    color: var(--text-muted); margin-bottom: 4px;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    font-weight: 600;
  }
  .sms-text {
    font-size: .95rem; color: var(--text); line-height: 1.5;
    font-family: Georgia, "Times New Roman", serif;
  }
  .sms-arrow {
    color: var(--text-muted); font-size: 1.2rem; flex-shrink: 0;
    transition: var(--transition);
  }
  .sms-card:active .sms-arrow { transform: translateX(4px); }

  /* ── Weekly Challenge ── */
  .challenge-card {
    padding: 32px 24px; text-align: center; min-height: 260px;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
  }
  .challenge-inner {
    transition: opacity .35s ease, transform .35s ease;
  }
  .challenge-inner.switching {
    opacity: 0; transform: translateY(20px) scale(.96);
  }
  .challenge-check {
    width: 44px; height: 44px; border-radius: 50%;
    border: 2px solid var(--love-pink); margin-top: 18px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: var(--transition);
    color: transparent;
    -webkit-tap-highlight-color: transparent;
  }
  .challenge-check svg { width: 24px; height: 24px; }
  .challenge-check.done {
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    border-color: var(--love-bright); color: #fff;
    box-shadow: 0 0 16px rgba(233,30,99,.4);
  }
  .challenge-check:active { transform: scale(.88); }
  .challenge-stats {
    text-align: center; margin-top: 18px; padding: 16px;
    font-size: .8rem; color: var(--text-muted);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  .challenge-bar {
    height: 4px; border-radius: 4px; margin: 8px auto 0;
    max-width: 240px; background: rgba(255,255,255,.08); overflow: hidden;
  }
  .challenge-bar-fill {
    height: 100%; border-radius: 4px;
    background: linear-gradient(90deg, var(--love-bright), var(--love-pink));
    transition: width .5s cubic-bezier(.4,0,.2,1); width: 0%;
  }
  @media (max-width: 480px) {
    .sms-card { padding: 14px; }
    .sms-text { font-size: .88rem; }
    .challenge-card { padding: 24px 16px; }
  }

  /* ── About the Author ── */
  .about-photo-wrap {
    position: relative; width: 180px; height: 180px;
    margin: 0 auto 24px; border-radius: 50%; overflow: visible;
  }
  .about-photo {
    width: 180px; height: 180px; border-radius: 50%; object-fit: cover;
    border: 3px solid rgba(233,30,99,.4);
    box-shadow: 0 8px 32px rgba(233,30,99,.3), 0 0 60px rgba(233,30,99,.1);
    position: relative; z-index: 1;
  }
  .about-photo-shine {
    position: absolute; top: -4px; left: -4px; right: -4px; bottom: -4px;
    border-radius: 50%; z-index: 2; pointer-events: none;
    background: linear-gradient(135deg, rgba(255,255,255,.25) 0%, transparent 50%, transparent 70%, rgba(255,255,255,.08) 100%);
    animation: aboutShine 4s ease-in-out infinite alternate;
  }
  @keyframes aboutShine {
    0% { opacity: .6; transform: rotate(0deg); }
    100% { opacity: 1; transform: rotate(8deg); }
  }
  .about-sparkle {
    position: absolute; font-size: 1rem; z-index: 3;
    animation: aboutSparkle 2s ease-in-out infinite;
    pointer-events: none;
  }
  .about-sparkle:nth-child(2) { top: 5%; right: 5%; animation-delay: 0s; }
  .about-sparkle:nth-child(3) { top: 50%; right: -8%; animation-delay: .7s; }
  .about-sparkle:nth-child(4) { bottom: 5%; right: 10%; animation-delay: 1.4s; }
  .about-sparkle:nth-child(5) { top: 15%; left: -5%; animation-delay: .4s; }
  .about-sparkle:nth-child(6) { bottom: 10%; left: 5%; animation-delay: 1.1s; }
  @keyframes aboutSparkle {
    0%, 100% { opacity: .3; transform: scale(.7); }
    50% { opacity: 1; transform: scale(1.2); }
  }
  .about-card {
    padding: 32px 24px; text-align: center;
  }
  .about-name {
    font-size: 1.4rem; font-weight: 700; color: var(--text);
    margin-bottom: 4px;
    font-family: Georgia, "Times New Roman", serif;
  }
  .about-title-sub {
    font-size: .82rem; color: var(--love-pink); font-style: italic;
    margin-bottom: 24px;
    font-family: Georgia, "Times New Roman", serif;
  }
  .about-text {
    font-size: .92rem; line-height: 1.8; color: var(--text-secondary);
    font-family: Georgia, "Times New Roman", serif;
    text-align: left; max-width: 420px; margin: 0 auto;
  }
  .about-text p { margin-bottom: 14px; }
  .about-text p:last-child { margin-bottom: 0; }
  .about-sig {
    margin-top: 28px; padding-top: 20px;
    border-top: 1px solid rgba(255,255,255,.08);
    font-size: .85rem; color: var(--love-pink);
    font-family: Georgia, "Times New Roman", serif;
    font-style: italic;
  }
  @media (max-width: 480px) {
    .about-photo-wrap, .about-photo { width: 150px; height: 150px; }
    .about-card { padding: 24px 16px; }
    .about-name { font-size: 1.2rem; }
    .about-text { font-size: .85rem; }
  }

  /* ── Word Jumble Game ── */
  .jumble-card {
    padding: 32px 24px; text-align: center;
  }
  .jumble-score {
    display: inline-block; padding: 6px 18px; border-radius: 20px;
    background: rgba(233,30,99,.2); color: var(--love-pink);
    font-size: .78rem; font-weight: 700; letter-spacing: .06em;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    margin-bottom: 20px;
  }
  .jumble-scrambled {
    font-size: 2.4rem; font-weight: 800; letter-spacing: .15em;
    color: var(--text); margin-bottom: 8px;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    word-break: break-all;
    transition: transform .3s ease;
  }
  .jumble-scrambled.shake {
    animation: jumbleShake .4s ease;
  }
  @keyframes jumbleShake {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-8px); }
    40% { transform: translateX(8px); }
    60% { transform: translateX(-5px); }
    80% { transform: translateX(5px); }
  }
  .jumble-hint {
    font-size: .8rem; color: var(--text-muted); margin-bottom: 20px;
    font-family: Georgia, "Times New Roman", serif; font-style: italic;
  }
  .jumble-input {
    width: 100%; max-width: 280px; padding: 14px 18px;
    border: 2px solid rgba(233,30,99,.3); border-radius: 14px;
    background: rgba(255,255,255,.06); color: var(--text);
    font-size: 1.1rem; font-weight: 600; text-align: center;
    letter-spacing: .08em; text-transform: uppercase;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    outline: none; transition: var(--transition);
    -webkit-appearance: none;
  }
  .jumble-input:focus { border-color: var(--love-bright); box-shadow: 0 0 20px rgba(233,30,99,.2); }
  .jumble-input::placeholder { color: var(--text-muted); text-transform: none; letter-spacing: normal; font-weight: 400; }
  .jumble-feedback {
    min-height: 36px; margin-top: 14px;
    font-size: .95rem; font-weight: 600;
    font-family: Georgia, "Times New Roman", serif;
    transition: opacity .3s ease;
  }
  .jumble-feedback.correct { color: #81c784; }
  .jumble-feedback.wrong { color: #ef9a9a; }
  .jumble-feedback.reveal { color: var(--love-pink); font-style: italic; }
  .jumble-btns {
    display: flex; gap: 10px; justify-content: center;
    margin-top: 18px; flex-wrap: wrap;
  }
  .jumble-btn {
    padding: 12px 24px; border: none; border-radius: 30px;
    font-size: .88rem; font-weight: 700; cursor: pointer;
    transition: var(--transition);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    -webkit-tap-highlight-color: transparent;
  }
  .jumble-btn:active { transform: scale(.93); }
  .jumble-btn-check {
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    color: #fff; box-shadow: 0 4px 16px rgba(233,30,99,.4);
  }
  .jumble-btn-check:hover { box-shadow: 0 6px 24px rgba(233,30,99,.5); }
  .jumble-btn-skip {
    background: var(--glass); color: var(--text-secondary);
    border: 1px solid var(--glass-border);
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
  }
  .jumble-btn-next {
    background: linear-gradient(135deg, rgba(255,215,0,.3), rgba(255,183,77,.2));
    color: var(--gold); border: 1px solid rgba(255,215,0,.3);
  }
  .jumble-celebrate {
    position: absolute; pointer-events: none;
    font-size: 1.4rem; opacity: 0;
    animation: jumbleCelebrate 1s ease-out forwards;
  }
  @keyframes jumbleCelebrate {
    0% { opacity: 1; transform: translate(0,0) scale(.5) rotate(0deg); }
    100% { opacity: 0; transform: translate(var(--cx), var(--cy)) scale(1.3) rotate(var(--cr)); }
  }
  @media (max-width: 480px) {
    .jumble-scrambled { font-size: 1.8rem; }
    .jumble-card { padding: 24px 16px; }
    .jumble-input { max-width: 240px; font-size: 1rem; padding: 12px 14px; }
  }

  /* ── Game Switcher ── */
  .game-switcher {
    display: flex; gap: 10px; justify-content: center; margin-bottom: 18px;
  }
  .game-switcher-btn {
    padding: 10px 22px; border: 2px solid rgba(233,30,99,.3); border-radius: 30px;
    background: var(--glass); color: var(--text-secondary);
    font-size: .88rem; font-weight: 700; cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
    transition: var(--transition); -webkit-tap-highlight-color: transparent;
  }
  .game-switcher-btn.active {
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    color: #fff; border-color: transparent;
    box-shadow: 0 4px 16px rgba(233,30,99,.4);
  }
  .game-switcher-btn:active { transform: scale(.93); }
  .game-section { display: none; }
  .game-section.active { display: block; }

  /* ── Word Search Game ── */
  .ws-card {
    padding: 24px 16px; text-align: center;
  }
  .ws-stats {
    display: flex; gap: 16px; justify-content: center; align-items: center;
    margin-bottom: 16px; flex-wrap: wrap;
  }
  .ws-stat {
    display: inline-block; padding: 6px 16px; border-radius: 20px;
    background: rgba(233,30,99,.2); color: var(--love-pink);
    font-size: .78rem; font-weight: 700; letter-spacing: .06em;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  .ws-grid-wrap {
    display: inline-block; position: relative;
    touch-action: none; user-select: none; -webkit-user-select: none;
    margin-bottom: 16px;
  }
  .ws-grid {
    display: grid; gap: 2px;
  }
  .ws-grid.size-12 { grid-template-columns: repeat(12, 1fr); }
  .ws-grid.size-10 { grid-template-columns: repeat(10, 1fr); }
  .ws-cell {
    width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;
    font-size: .85rem; font-weight: 700; color: var(--text);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    border-radius: 6px; background: rgba(255,255,255,.06);
    cursor: pointer; transition: background .15s, transform .15s;
    position: relative; z-index: 1;
  }
  .ws-cell.selecting {
    background: rgba(233,30,99,.35); transform: scale(1.08);
  }
  .ws-cell.found-0 { background: rgba(233,30,99,.45); color: #fff; }
  .ws-cell.found-1 { background: rgba(156,39,176,.45); color: #fff; }
  .ws-cell.found-2 { background: rgba(103,58,183,.45); color: #fff; }
  .ws-cell.found-3 { background: rgba(33,150,243,.45); color: #fff; }
  .ws-cell.found-4 { background: rgba(0,150,136,.45); color: #fff; }
  .ws-cell.found-5 { background: rgba(255,152,0,.45); color: #fff; }
  .ws-cell.found-6 { background: rgba(244,67,54,.45); color: #fff; }
  .ws-cell.found-7 { background: rgba(63,81,181,.45); color: #fff; }
  .ws-selection-line {
    position: absolute; pointer-events: none; z-index: 0;
    background: rgba(233,30,99,.25); border-radius: 16px;
  }
  .ws-wordlist {
    display: flex; flex-wrap: wrap; gap: 8px; justify-content: center;
    margin-bottom: 18px;
  }
  .ws-word-tag {
    padding: 5px 14px; border-radius: 18px;
    background: rgba(255,255,255,.08); color: var(--text-secondary);
    font-size: .78rem; font-weight: 600; letter-spacing: .04em;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    transition: var(--transition);
  }
  .ws-word-tag.found {
    background: rgba(129,199,132,.25); color: #81c784;
    text-decoration: line-through;
  }
  .ws-btn-new {
    padding: 12px 28px; border: none; border-radius: 30px;
    background: linear-gradient(135deg, rgba(255,215,0,.3), rgba(255,183,77,.2));
    color: var(--gold); border: 1px solid rgba(255,215,0,.3);
    font-size: .88rem; font-weight: 700; cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    transition: var(--transition); -webkit-tap-highlight-color: transparent;
  }
  .ws-btn-new:active { transform: scale(.93); }
  .ws-celebrate {
    position: absolute; pointer-events: none;
    font-size: 1.4rem; opacity: 0;
    animation: jumbleCelebrate 1s ease-out forwards;
  }
  .ws-complete-msg {
    margin-top: 14px; font-size: 1.1rem; font-weight: 700;
    color: #81c784; font-family: Georgia, "Times New Roman", serif;
    opacity: 0; transition: opacity .5s ease;
  }
  .ws-complete-msg.show { opacity: 1; }
  @media (max-width: 480px) {
    .ws-cell { width: 28px; height: 28px; font-size: .75rem; }
    .ws-card { padding: 18px 10px; }
  }

  /* ── Game Switcher flex-wrap ── */
  .game-switcher { flex-wrap: wrap; }

  /* ── HP Trivia Game ── */
  .hp-card {
    padding: 28px 20px; text-align: center; position: relative; overflow: hidden;
  }
  .hp-score {
    display: inline-block; padding: 6px 18px; border-radius: 20px;
    background: rgba(255,215,0,.18); color: var(--gold);
    font-size: .78rem; font-weight: 700; letter-spacing: .06em;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    margin-bottom: 18px;
  }
  .hp-difficulty {
    display: inline-block; margin-left: 8px; padding: 3px 10px; border-radius: 12px;
    font-size: .65rem; font-weight: 700; text-transform: uppercase; letter-spacing: .08em;
  }
  .hp-difficulty.easy { background: rgba(129,199,132,.25); color: #81c784; }
  .hp-difficulty.medium { background: rgba(255,183,77,.25); color: #ffb74d; }
  .hp-difficulty.hard { background: rgba(239,154,154,.25); color: #ef9a9a; }
  .hp-qnum {
    font-size: .72rem; color: var(--text-muted); margin-bottom: 8px;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  .hp-question {
    font-size: 1.15rem; font-weight: 700; color: var(--text);
    font-family: Georgia, "Times New Roman", serif;
    line-height: 1.5; margin-bottom: 22px; min-height: 60px;
  }
  .hp-answers {
    display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
    margin-bottom: 18px;
  }
  .hp-answer {
    padding: 14px 12px; border: 2px solid rgba(255,215,0,.2); border-radius: 14px;
    background: rgba(255,255,255,.06); color: var(--text);
    font-size: .88rem; font-weight: 600; cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    transition: var(--transition); -webkit-tap-highlight-color: transparent;
    text-align: center; line-height: 1.3;
  }
  .hp-answer:active { transform: scale(.95); }
  .hp-answer.selected {
    border-color: var(--gold); background: rgba(255,215,0,.15);
    box-shadow: 0 0 16px rgba(255,215,0,.2);
  }
  .hp-answer.correct {
    border-color: #81c784; background: rgba(129,199,132,.25);
    color: #c8e6c9;
  }
  .hp-answer.wrong {
    border-color: #ef9a9a; background: rgba(239,154,154,.2);
    color: #ef9a9a; opacity: .7;
  }
  .hp-answer.disabled { pointer-events: none; }
  .hp-answer.reveal-correct {
    border-color: #81c784; background: rgba(129,199,132,.25);
    color: #c8e6c9;
  }
  .hp-feedback {
    min-height: 48px; margin-bottom: 16px;
    font-size: .92rem; font-weight: 600;
    font-family: Georgia, "Times New Roman", serif;
    line-height: 1.4; transition: opacity .3s ease;
  }
  .hp-feedback.correct { color: #81c784; }
  .hp-feedback.wrong { color: #ef9a9a; }
  .hp-btns {
    display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;
  }
  .hp-btn-submit {
    padding: 12px 28px; border: none; border-radius: 30px;
    background: linear-gradient(135deg, #ffd700, #ffb300);
    color: #1a0a1e; font-size: .88rem; font-weight: 800; cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    transition: var(--transition); -webkit-tap-highlight-color: transparent;
    box-shadow: 0 4px 16px rgba(255,215,0,.3);
  }
  .hp-btn-submit:active { transform: scale(.93); }
  .hp-btn-submit:disabled { opacity: .4; cursor: default; }
  .hp-btn-next {
    padding: 12px 28px; border: none; border-radius: 30px;
    background: linear-gradient(135deg, var(--love-bright), #c2185b);
    color: #fff; font-size: .88rem; font-weight: 700; cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    transition: var(--transition); -webkit-tap-highlight-color: transparent;
    box-shadow: 0 4px 16px rgba(233,30,99,.4);
    display: none;
  }
  .hp-btn-next:active { transform: scale(.93); }
  .hp-streak {
    margin-top: 12px; font-size: .75rem; color: var(--text-muted);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    min-height: 20px;
  }
  .hp-celebrate {
    position: absolute; pointer-events: none;
    font-size: 1.4rem; opacity: 0;
    animation: jumbleCelebrate 1s ease-out forwards;
  }
  @media (max-width: 480px) {
    .hp-card { padding: 22px 14px; }
    .hp-question { font-size: 1rem; }
    .hp-answers { grid-template-columns: 1fr; }
    .hp-answer { padding: 12px 10px; font-size: .84rem; }
  }

  /* ── My Purses Gallery ── */
  .purse-subtitle {
    text-align: center; font-size: .85rem; color: var(--text-muted);
    font-family: Georgia, "Times New Roman", serif; font-style: italic;
    margin-bottom: 20px;
  }
  .purse-grid {
    display: grid; grid-template-columns: repeat(2, 1fr); gap: 14px;
    padding: 0 4px;
  }
  @media (min-width: 600px) { .purse-grid { grid-template-columns: repeat(3, 1fr); } }
  @media (min-width: 900px) { .purse-grid { grid-template-columns: repeat(4, 1fr); } }
  .purse-card {
    border-radius: 18px; overflow: hidden; cursor: pointer;
    background: var(--glass); border: 2px solid rgba(233,30,99,.2);
    backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
    transition: transform .3s ease, box-shadow .3s ease;
    -webkit-tap-highlight-color: transparent;
  }
  .purse-card:active { transform: scale(.96); }
  .purse-card:hover { box-shadow: 0 8px 32px rgba(233,30,99,.25); transform: translateY(-2px); }
  .purse-card-img {
    width: 100%; aspect-ratio: 1; object-fit: cover; display: block;
  }
  .purse-card-info {
    padding: 10px 12px; text-align: center;
  }
  .purse-card-brand {
    font-size: .78rem; font-weight: 700; color: var(--gold);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
    letter-spacing: .04em;
  }
  .purse-card-caption {
    font-size: .7rem; color: var(--text-muted); margin-top: 2px;
    font-family: Georgia, "Times New Roman", serif; font-style: italic;
  }
  .purse-count {
    text-align: center; margin-bottom: 16px;
  }
  .purse-count-badge {
    display: inline-block; padding: 6px 18px; border-radius: 20px;
    background: rgba(255,215,0,.18); color: var(--gold);
    font-size: .78rem; font-weight: 700; letter-spacing: .06em;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  .purse-note {
    text-align: center; padding: 20px 16px 4px; color: var(--text-muted);
    font-family: Georgia, "Times New Roman", serif; font-style: italic;
    font-size: .82rem;
  }

  /* Purse Lightbox */
  .purse-lightbox {
    position: fixed; inset: 0; z-index: 9999;
    background: rgba(0,0,0,.92); display: none;
    align-items: center; justify-content: center;
    flex-direction: column;
    -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px);
  }
  .purse-lightbox.open { display: flex; }
  .purse-lightbox-close {
    position: absolute; top: 16px; right: 18px;
    font-size: 2rem; color: #fff; background: none; border: none;
    cursor: pointer; z-index: 10; -webkit-tap-highlight-color: transparent;
    width: 44px; height: 44px; display: flex; align-items: center; justify-content: center;
  }
  .purse-lightbox-img {
    max-width: 90vw; max-height: 75vh; border-radius: 16px;
    object-fit: contain; transition: transform .3s ease;
    user-select: none; -webkit-user-select: none;
  }
  .purse-lightbox-caption {
    color: #fff; text-align: center; margin-top: 14px; padding: 0 20px;
    font-family: Georgia, "Times New Roman", serif; font-style: italic;
    font-size: .9rem; opacity: .85;
  }
  .purse-lightbox-nav {
    position: absolute; top: 50%; transform: translateY(-50%);
    font-size: 2.4rem; color: rgba(255,255,255,.7); background: none; border: none;
    cursor: pointer; padding: 12px; -webkit-tap-highlight-color: transparent;
    z-index: 10;
  }
  .purse-lightbox-nav:hover { color: #fff; }
  .purse-lightbox-prev { left: 8px; }
  .purse-lightbox-next { right: 8px; }
  .purse-lightbox-counter {
    color: rgba(255,255,255,.5); font-size: .75rem; margin-top: 8px;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
  }
  @media (max-width: 480px) {
    .purse-grid { gap: 10px; }
    .purse-card-info { padding: 8px 8px; }
    .purse-card-brand { font-size: .72rem; }
    .purse-lightbox-nav { font-size: 1.8rem; padding: 8px; }
  }
</style>
</head>
<body>

<!-- Floating hearts background -->
<div class="hearts-container" id="heartsContainer"></div>

<div class="container">

  <!-- Header -->
  <div class="header fade-in fade-in-1">
    <div class="header-heart">💝</div>
    <h1 class="header-title">For My Beautiful Katy ❤️</h1>
    <p class="header-subtitle">Happy Valentine's Day 2026</p>
  </div>

  <!-- Navigation -->
  <div class="nav-tabs fade-in fade-in-1" id="navTabs">
    <button class="nav-tab active" onclick="showPage('home')">Home</button>
    <button class="nav-tab" onclick="showPage('sexy')">Sexy</button>
    <button class="nav-tab" onclick="showPage('coupons')">Coupons</button>
    <button class="nav-tab" onclick="showPage('hunt')">Hunt</button>
    <button class="nav-tab" onclick="showPage('poems')">Poems</button>
    <button class="nav-tab" onclick="showPage('fascinate')">Video</button>
    <button class="nav-tab" onclick="showPage('dates')">Dates</button>
    <button class="nav-tab" onclick="showPage('compliments')">Sweet</button>
    <button class="nav-tab" onclick="showPage('dinner')">Dinner</button>
    <button class="nav-tab" onclick="showPage('booth')">Booth</button>
    <button class="nav-tab" onclick="showPage('textme')">Text Me</button>
    <button class="nav-tab" onclick="showPage('challenge')">Challenge</button>
    <button class="nav-tab" onclick="showPage('games')">Games</button>
    <button class="nav-tab" onclick="showPage('purses')">Purses</button>
    <button class="nav-tab" onclick="showPage('about')">About</button>
  </div>

  <!-- ════ HOME PAGE ════ -->
  <div class="page active" id="page-home">

    <!-- Photo Gallery -->
    <div class="gallery-section">
      <div class="gallery-label">✨ Our Beautiful Family ✨</div>
      <div class="gallery glass" id="gallery">
        <div class="gallery-track" id="galleryTrack">
          <div class="gallery-slide">
            <img src="/static/photos/photo1.jpg" alt="Brad and Katy embracing">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/photo2.jpg" alt="The whole family together">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/photo3.jpg" alt="Brad and Katy walking together">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/photo4.jpg" alt="Family on the front steps">
          </div>
        </div>
        <div class="sparkle-overlay"></div>
        <button class="gallery-arrow prev" onclick="prevSlide()">&#8249;</button>
        <button class="gallery-arrow next" onclick="nextSlide()">&#8250;</button>
      </div>
      <div class="gallery-dots" id="galleryDots">
        <div class="gallery-dot active" onclick="goToSlide(0)"></div>
        <div class="gallery-dot" onclick="goToSlide(1)"></div>
        <div class="gallery-dot" onclick="goToSlide(2)"></div>
        <div class="gallery-dot" onclick="goToSlide(3)"></div>
      </div>
    </div>

    <div class="divider">&#9829; &#9829; &#9829;</div>

    <!-- Music Player -->
    <div class="music-section">
      <div class="music-player glass">
        <button class="music-btn" id="musicBtn" onclick="toggleMusic()">
          <svg id="playIcon" width="22" height="22" viewBox="0 0 24 24" fill="white">
            <polygon points="6,3 20,12 6,21"/>
          </svg>
          <svg id="pauseIcon" width="22" height="22" viewBox="0 0 24 24" fill="white" style="display:none">
            <rect x="5" y="3" width="5" height="18" rx="1"/>
            <rect x="14" y="3" width="5" height="18" rx="1"/>
          </svg>
        </button>
        <div class="music-info">
          <div class="music-title" id="musicTitle">My Home &#8212; Myles Smith <span class="music-note">&#9834;</span></div>
          <div class="music-artist" id="musicArtist">Song 1 of 2 &#128149;</div>
          <div class="music-progress" id="progressBar" onclick="seekMusic(event)">
            <div class="music-progress-fill" id="progressFill"></div>
          </div>
          <div class="music-time">
            <span id="currentTime">0:00</span>
            <span id="totalTime">0:00</span>
          </div>
        </div>
        <div class="visualizer paused" id="visualizer">
          <div class="viz-bar"></div>
          <div class="viz-bar"></div>
          <div class="viz-bar"></div>
          <div class="viz-bar"></div>
          <div class="viz-bar"></div>
        </div>
        <button class="skip-btn" onclick="skipTrack()" title="Next song">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="white"><polygon points="4,3 16,12 4,21"/><rect x="17" y="3" width="3" height="18" rx="1"/></svg>
        </button>
      </div>
    </div>

    <div class="divider">&#9829; &#9829; &#9829;</div>

    <!-- Love Message -->
    <div class="message-section">
      <div class="love-message glass">
        <span class="message-icon">&#128140;</span>
        <p class="message-text">
          Katy, I love and appreciate you more than words can say.
          Thank you for being the rock of our family and the best mother in the world.
          You make our house a home, and I'm so grateful for everything you do.
          Happy Valentine's Day! &#10084;&#65039;
        </p>
        <p class="message-signature">Forever yours, Brad &#128149;</p>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ SEXY PAGE ════ -->
  <div class="page" id="page-sexy">

    <div class="gallery-section">
      <div class="gallery-label">&#128293; You're One Sexy Woman &#128293;</div>
      <div class="gallery glass" id="sexyGallery">
        <div class="gallery-track" id="sexyTrack">
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy1.jpg" alt="Katy photo 1">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy2.jpg" alt="Katy photo 2">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy3.jpg" alt="Katy photo 3">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy4.jpg" alt="Katy photo 4">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy5.jpg" alt="Katy photo 5">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy6.jpg" alt="Katy photo 6">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy7.jpg" alt="Katy photo 7">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy8.jpg" alt="Katy photo 8">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy9.jpg" alt="Katy photo 9">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy10.jpg" alt="Katy photo 10">
          </div>
          <div class="gallery-slide">
            <img src="/static/photos/sexy/sexy11.jpg" alt="Katy photo 11">
          </div>
        </div>
        <div class="sparkle-overlay"></div>
        <button class="gallery-arrow prev" onclick="prevSexy()">&#8249;</button>
        <button class="gallery-arrow next" onclick="nextSexy()">&#8250;</button>
      </div>
      <div class="gallery-dots" id="sexyDots"></div>
    </div>

    <div class="message-section">
      <div class="love-message glass">
        <span class="message-icon">&#128293;</span>
        <p class="message-text">
          You are the most beautiful woman in the world, Katy.
          Every day I'm reminded how lucky I am. &#10084;&#65039;
        </p>
      </div>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ COUPONS PAGE ════ -->
  <div class="page" id="page-coupons">

    <div class="gallery-label">&#127873; Love Coupons &#127873;</div>

    <div class="coupon-card glass" id="coupon-0" onclick="toggleCoupon(0)">
      <div class="coupon-check" id="coupon-check-0">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
      </div>
      <div class="coupon-body">
        <div class="coupon-emoji">&#128134;</div>
        <div class="coupon-title">5-Minute Back Rub</div>
        <div class="coupon-desc">Brad gives Katy a relaxing 5-minute back rub, no questions asked.</div>
      </div>
      <div class="coupon-redeemed-badge">Redeemed</div>
    </div>

    <div class="coupon-card glass" id="coupon-1" onclick="toggleCoupon(1)">
      <div class="coupon-check" id="coupon-check-1">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
      </div>
      <div class="coupon-body">
        <div class="coupon-emoji">&#128064;</div>
        <div class="coupon-title">One Minute of Uninterrupted Eye Contact</div>
        <div class="coupon-desc">Brad and Katy share 1 full minute of deep, uninterrupted eye contact.</div>
      </div>
      <div class="coupon-redeemed-badge">Redeemed</div>
    </div>

    <div class="coupon-card glass" id="coupon-2" onclick="toggleCoupon(2)">
      <div class="coupon-check" id="coupon-check-2">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
      </div>
      <div class="coupon-body">
        <div class="coupon-emoji">&#127869;</div>
        <div class="coupon-title">Make Me a Meal and Bring It to Me</div>
        <div class="coupon-desc">Brad cooks Katy a meal of her choice and serves it to her wherever she is.</div>
      </div>
      <div class="coupon-redeemed-badge">Redeemed</div>
    </div>

    <div class="coupon-card glass" id="coupon-3" onclick="toggleCoupon(3)">
      <div class="coupon-check" id="coupon-check-3">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
      </div>
      <div class="coupon-body">
        <div class="coupon-emoji">&#128170;</div>
        <div class="coupon-title">You Have to Deal With This, No Matter What</div>
        <div class="coupon-desc">Brad has to handle whatever Katy needs &#8212; no excuses, no delays, no complaints.</div>
      </div>
      <div class="coupon-redeemed-badge">Redeemed</div>
    </div>

    <div class="coupon-fine-print">
      Valid through 2026 &#8226; Redeemable by Katy, honored by Brad &#10084;&#65039;
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ SCAVENGER HUNT PAGE ════ -->
  <div class="page" id="page-hunt">

    <div class="hunt-intro glass">
      <span class="hunt-intro-icon">&#128270;</span>
      <p class="hunt-intro-text">
        Solve each riddle to unlock the next clue. Brad will be there to help if you get stuck! Your Valentine&#8217;s gift awaits at the end. &#10084;&#65039;
      </p>
    </div>

    <div class="hunt-progress" id="huntProgress">Clue 1 of 8</div>
    <div class="hunt-progress-bar"><div class="hunt-progress-fill" id="huntProgressFill"></div></div>

    <div style="margin-top:18px">

      <div class="hunt-clue glass" id="hunt-0" onclick="solveClue(0)">
        <div class="hunt-clue-check" id="hunt-check-0">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <div class="hunt-clue-body">
          <div class="hunt-clue-number">Clue 1</div>
          <div class="hunt-clue-text">&#8220;I&#8217;m the only reason Brad&#8217;s still married. Without me, you&#8217;d have committed justifiable homicide years ago. I transform hell into tolerable, one ritual at a time.&#8221;</div>
        </div>
      </div>

      <div class="hunt-clue glass locked" id="hunt-1" onclick="solveClue(1)">
        <div class="hunt-clue-check" id="hunt-check-1">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <div class="hunt-clue-body">
          <div class="hunt-clue-number">Clue 2</div>
          <div class="hunt-clue-text">&#8220;I&#8217;m the homewrecker who lives in your house. You feed me regularly and I repay you with theft. My victims vanish without a trace and you just&#8230; keep using me anyway.&#8221;</div>
        </div>
        <span class="hunt-clue-lock">&#128274;</span>
      </div>

      <div class="hunt-clue glass locked" id="hunt-2" onclick="solveClue(2)">
        <div class="hunt-clue-check" id="hunt-check-2">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <div class="hunt-clue-body">
          <div class="hunt-clue-number">Clue 3</div>
          <div class="hunt-clue-text">&#8220;I&#8217;m a morgue that hums constantly. Your optimism dies here in transparent coffins while I pretend not to notice. I preserve corpses but can&#8217;t save good intentions.&#8221;</div>
        </div>
        <span class="hunt-clue-lock">&#128274;</span>
      </div>

      <div class="hunt-clue glass locked" id="hunt-3" onclick="solveClue(3)">
        <div class="hunt-clue-check" id="hunt-check-3">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <div class="hunt-clue-body">
          <div class="hunt-clue-number">Clue 4</div>
          <div class="hunt-clue-text">&#8220;I tell the truth but show it backwards. Shatter me for seven years of misery. I&#8217;ve witnessed your naked confidence more times than Brad has&#8212;and I never complain about the view.&#8221;</div>
        </div>
        <span class="hunt-clue-lock">&#128274;</span>
      </div>

      <div class="hunt-clue glass locked" id="hunt-4" onclick="solveClue(4)">
        <div class="hunt-clue-check" id="hunt-check-4">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <div class="hunt-clue-body">
          <div class="hunt-clue-number">Clue 5</div>
          <div class="hunt-clue-text">&#8220;Our warranty expired after incident number two. I&#8217;ve survived earthquakes that had nothing to do with geology. Physics met passion here repeatedly&#8212;physics lost every time.&#8221;</div>
        </div>
        <span class="hunt-clue-lock">&#128274;</span>
      </div>

      <div class="hunt-clue glass locked" id="hunt-5" onclick="solveClue(5)">
        <div class="hunt-clue-check" id="hunt-check-5">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <div class="hunt-clue-body">
          <div class="hunt-clue-number">Clue 6</div>
          <div class="hunt-clue-text">&#8220;I&#8217;m a monument to masculine delusion. Three levels of &#8216;someday&#8217; collecting dust beside tools of abandoned ambition. The graveyard where projects go to feel less alone.&#8221;</div>
        </div>
        <span class="hunt-clue-lock">&#128274;</span>
      </div>

      <div class="hunt-clue glass locked" id="hunt-6" onclick="solveClue(6)">
        <div class="hunt-clue-check" id="hunt-check-6">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <div class="hunt-clue-body">
          <div class="hunt-clue-number">Clue 7</div>
          <div class="hunt-clue-text">&#8220;I&#8217;m the guardian between your sanctuary and the world&#8217;s chaos. I swing both ways without shame. My highest point conceals secrets my lowest point could never imagine.&#8221;</div>
        </div>
        <span class="hunt-clue-lock">&#128274;</span>
      </div>

      <div class="hunt-clue glass locked" id="hunt-7" onclick="solveClue(7)">
        <div class="hunt-clue-check" id="hunt-check-7">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        </div>
        <div class="hunt-clue-body">
          <div class="hunt-clue-number">Clue 8</div>
          <div class="hunt-clue-text">&#8220;I&#8217;m enslaved to ancient decomposed forests. My heart pumps 2000 times per minute when Brad&#8217;s impatient. I bleed when wounded and scream when violated. Your treasure waits in my hollow core.&#8221;</div>
        </div>
        <span class="hunt-clue-lock">&#128274;</span>
      </div>

    </div>

    <div class="hunt-complete glass" id="huntComplete">
      <span class="hunt-complete-icon">&#128157;</span>
      <div class="hunt-complete-title">Congratulations!</div>
      <p class="hunt-complete-text">You solved them all! Now go claim your prize! &#128157;</p>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ POEMS PAGE ════ -->
  <div class="page" id="page-poems">

    <div class="poem-viewer" id="poemViewer">
      <div class="poem-track" id="poemTrack">

        <!-- Poem 1 -->
        <div class="poem-page">
          <div class="poem-number">Poem 1 of 10</div>
          <div class="poem-title">How Do I Love Thee?</div>
          <div class="poem-author">Elizabeth Barrett Browning</div>
          <div class="poem-body">
<span class="stanza">How do I love thee? Let me count the ways.
I love thee to the depth and breadth and height
My soul can reach, when feeling out of sight
For the ends of being and ideal grace.</span>
<span class="stanza">I love thee to the level of every day's
Most quiet need, by sun and candle-light.
I love thee freely, as men strive for right.
I love thee purely, as they turn from praise.</span>
<span class="stanza">I love thee with the passion put to use
In my old griefs, and with my childhood's faith.
I love thee with a love I seemed to lose
With my lost saints. I love thee with the breath,
Smiles, tears, of all my life; and, if God choose,
I shall but love thee better after death.</span>
          </div>
        </div>

        <!-- Poem 2 -->
        <div class="poem-page">
          <div class="poem-number">Poem 2 of 10</div>
          <div class="poem-title">Sonnet 116</div>
          <div class="poem-author">William Shakespeare</div>
          <div class="poem-body">
<span class="stanza">Let me not to the marriage of true minds
Admit impediments. Love is not love
Which alters when it alteration finds,
Or bends with the remover to remove.</span>
<span class="stanza">O no! it is an ever-fixed mark
That looks on tempests and is never shaken;
It is the star to every wand'ring bark,
Whose worth's unknown, although his height be taken.</span>
<span class="stanza">Love's not Time's fool, though rosy lips and cheeks
Within his bending sickle's compass come;
Love alters not with his brief hours and weeks,
But bears it out even to the edge of doom.</span>
<span class="stanza">If this be error and upon me prov'd,
I never writ, nor no man ever lov'd.</span>
          </div>
        </div>

        <!-- Poem 3 -->
        <div class="poem-page">
          <div class="poem-number">Poem 3 of 10</div>
          <div class="poem-title">She Walks in Beauty</div>
          <div class="poem-author">Lord Byron</div>
          <div class="poem-body">
<span class="stanza">She walks in beauty, like the night
Of cloudless climes and starry skies;
And all that's best of dark and bright
Meet in her aspect and her eyes;
Thus mellowed to that tender light
Which heaven to gaudy day denies.</span>
<span class="stanza">One shade the more, one ray the less,
Had half impaired the nameless grace
Which waves in every raven tress,
Or softly lightens o'er her face;
Where thoughts serenely sweet express,
How pure, how dear their dwelling-place.</span>
<span class="stanza">And on that cheek, and o'er that brow,
So soft, so calm, yet eloquent,
The smiles that win, the tints that glow,
But tell of days in goodness spent,
A mind at peace with all below,
A heart whose love is innocent!</span>
          </div>
        </div>

        <!-- Poem 4 -->
        <div class="poem-page">
          <div class="poem-number">Poem 4 of 10</div>
          <div class="poem-title">i carry your heart with me</div>
          <div class="poem-author">E.E. Cummings</div>
          <div class="poem-body">
<span class="stanza">i carry your heart with me(i carry it in
my heart)i am never without it(anywhere
i go you go,my dear;and whatever is done
by only me is your doing,my darling)</span>
<span class="stanza">i fear no fate(for you are my fate,my sweet)i want
no world(for beautiful you are my world,my true)
and it's you are whatever a moon has always meant
and whatever a sun will always sing is you</span>
<span class="stanza">here is the deepest secret nobody knows
(here is the root of the root and the bud of the bud
and the sky of the sky of a tree called life;which grows
higher than soul can hope or mind can hide)
and this is the wonder that's keeping the stars apart</span>
<span class="stanza">i carry your heart(i carry it in my heart)</span>
          </div>
        </div>

        <!-- Poem 5 -->
        <div class="poem-page">
          <div class="poem-number">Poem 5 of 10</div>
          <div class="poem-title">Love's Philosophy</div>
          <div class="poem-author">Percy Bysshe Shelley</div>
          <div class="poem-body">
<span class="stanza">The fountains mingle with the river
And the rivers with the ocean,
The winds of heaven mix for ever
With a sweet emotion;
Nothing in the world is single;
All things by a law divine
In one spirit meet and mingle.
Why not I with thine?&#8212;</span>
<span class="stanza">See the mountains kiss high heaven
And the waves clasp one another;
No sister-flower would be forgiven
If it disdained its brother;
And the sunlight clasps the earth
And the moonbeams kiss the sea:
What is all this sweet work worth
If thou kiss not me?</span>
          </div>
        </div>

        <!-- Poem 6 -->
        <div class="poem-page">
          <div class="poem-number">Poem 6 of 10</div>
          <div class="poem-title">A Red, Red Rose</div>
          <div class="poem-author">Robert Burns</div>
          <div class="poem-body">
<span class="stanza">O my Luve is like a red, red rose
That's newly sprung in June;
O my Luve is like the melody
That's sweetly played in tune.</span>
<span class="stanza">So fair art thou, my bonnie lass,
So deep in luve am I;
And I will luve thee still, my dear,
Till a' the seas gang dry.</span>
<span class="stanza">Till a' the seas gang dry, my dear,
And the rocks melt wi' the sun;
I will luve thee still, my dear,
While the sands o' life shall run.</span>
<span class="stanza">And fare thee weel, my only luve!
And fare thee weel awhile!
And I will come again, my luve,
Though it were ten thousand mile.</span>
          </div>
        </div>

        <!-- Poem 7 -->
        <div class="poem-page">
          <div class="poem-number">Poem 7 of 10</div>
          <div class="poem-title">Wild Nights</div>
          <div class="poem-author">Emily Dickinson</div>
          <div class="poem-body">
<span class="stanza">Wild Nights &#8212; Wild Nights!
Were I with thee
Wild Nights should be
Our luxury!</span>
<span class="stanza">Futile &#8212; the winds &#8212;
To a Heart in port &#8212;
Done with the Compass &#8212;
Done with the Chart!</span>
<span class="stanza">Rowing in Eden &#8212;
Ah, the Sea!
Might I but moor &#8212; tonight &#8212;
In thee!</span>
          </div>
        </div>

        <!-- Poem 8 -->
        <div class="poem-page">
          <div class="poem-number">Poem 8 of 10</div>
          <div class="poem-title">When You Are Old</div>
          <div class="poem-author">W.B. Yeats</div>
          <div class="poem-body">
<span class="stanza">When you are old and grey and full of sleep,
And nodding by the fire, take down this book,
And slowly read, and dream of the soft look
Your eyes had once, and of their shadows deep;</span>
<span class="stanza">How many loved your moments of glad grace,
And loved your beauty with love false or true,
But one man loved the pilgrim soul in you,
And loved the sorrows of your changing face;</span>
<span class="stanza">And bending down beside the glowing bars,
Murmur, a little sadly, how Love fled
And paced upon the mountains overhead
And hid his face amid a crowd of stars.</span>
          </div>
        </div>

        <!-- Poem 9 -->
        <div class="poem-page">
          <div class="poem-number">Poem 9 of 10</div>
          <div class="poem-title">To My Dear and Loving Husband</div>
          <div class="poem-author">Anne Bradstreet</div>
          <div class="poem-body">
<span class="stanza">If ever two were one, then surely we.
If ever man were loved by wife, then thee;
If ever wife was happy in a man,
Compare with me, ye women, if you can.</span>
<span class="stanza">I prize thy love more than whole mines of gold
Or all the riches that the East doth hold.
My love is such that rivers cannot quench,
Nor ought but love from thee, give recompense.</span>
<span class="stanza">Thy love is such I can no way repay,
The heavens reward thee manifold, I pray.
Then while we live, in love let's so persevere
That when we live no more, we may live ever.</span>
          </div>
        </div>

        <!-- Poem 10 -->
        <div class="poem-page">
          <div class="poem-number">Poem 10 of 10</div>
          <div class="poem-title">The Passionate Shepherd to His Love</div>
          <div class="poem-author">Christopher Marlowe</div>
          <div class="poem-body">
<span class="stanza">Come live with me and be my love,
And we will all the pleasures prove
That valleys, groves, hills, and fields,
Woods, or steepy mountain yields.</span>
<span class="stanza">And we will sit upon the rocks,
Seeing the shepherds feed their flocks,
By shallow rivers to whose falls
Melodious birds sing madrigals.</span>
<span class="stanza">And I will make thee beds of roses
And a thousand fragrant posies,
A cap of flowers, and a kirtle
Embroidered all with leaves of myrtle;</span>
<span class="stanza">A gown made of the finest wool
Which from our pretty lambs we pull;
Fair lined slippers for the cold,
With buckles of the purest gold;</span>
<span class="stanza">A belt of straw and ivy buds,
With coral clasps and amber studs:
And if these pleasures may thee move,
Come live with me, and be my love.</span>
          </div>
        </div>

      </div>
    </div>

    <!-- Poem navigation -->
    <div class="poem-nav">
      <button class="poem-arrow" id="poemPrev" onclick="prevPoem()">&#8249;</button>
      <span class="poem-counter" id="poemCounter">1 / 10</span>
      <button class="poem-arrow" id="poemNext" onclick="nextPoem()">&#8250;</button>
    </div>
    <div class="poem-dots" id="poemDots"></div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ YOU FASCINATE ME PAGE ════ -->
  <div class="page" id="page-fascinate">

    <div class="gallery-label">&#128525; You Fascinate Me &#128525;</div>

    <div class="video-section">
      <div class="video-container glass" id="videoContainer1">
        <video id="fascinateVideo" playsinline preload="metadata">
          <source src="/static/you-fascinate-me.mp4" type="video/mp4">
        </video>
        <div class="video-play-overlay" id="videoPlayOverlay" onclick="toggleFascinateVideo()">
          <div class="video-play-btn">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="white"><polygon points="6,3 20,12 6,21"/></svg>
          </div>
        </div>
      </div>
      <div class="video-container glass" id="videoContainer2" style="display:none; margin-top:16px;">
        <video id="fascinateVideo2" playsinline preload="metadata">
          <source src="/static/ghost-kiss.mp4" type="video/mp4">
        </video>
      </div>
    </div>

    <div class="video-quote glass">
      <p class="video-quote-text">&#8220;You fascinate me.&#8221;</p>
      <p class="video-quote-attr">&#8212; How Brad feels every single day &#10084;&#65039;</p>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ DATE NIGHT IDEAS PAGE ════ -->
  <div class="page" id="page-dates">

    <div class="gallery-label">&#127769; Date Night Generator &#127769;</div>

    <div class="gen-card glass" id="dateCard">
      <div class="gen-card-inner" id="dateInner">
        <span class="gen-icon" id="dateIcon">&#127769;</span>
        <span class="gen-category romantic" id="dateCat">Romantic</span>
        <div class="gen-title" id="dateTitle">Tap below to get a date night idea!</div>
        <div class="gen-desc" id="dateDesc">Brad and Katy's personal date night spinner</div>
        <div class="gen-meta" id="dateMeta"></div>
      </div>
      <button class="gen-btn" onclick="spinDate()">&#127922; Spin for a Date!</button>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ COMPLIMENTS FOR KATY PAGE ════ -->
  <div class="page" id="page-compliments">

    <div class="gallery-label">&#128149; Compliments for Katy &#128149;</div>

    <div class="gen-card glass" id="complimentCard">
      <span class="gen-icon">&#128156;</span>
      <span class="gen-category sweet" id="complimentCat">Sweet</span>
      <p class="compliment-text" id="complimentText">Tap below to hear something true about you &#10084;&#65039;</p>
      <button class="gen-btn" onclick="newCompliment()">&#128149; Another One</button>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ WHAT'S FOR DINNER PAGE ════ -->
  <div class="page" id="page-dinner">

    <div class="gallery-label">&#127869; What's for Dinner? &#127869;</div>

    <div class="gen-card glass" id="dinnerCard">
      <div class="gen-card-inner" id="dinnerInner">
        <span class="gen-icon" id="dinnerIcon">&#127869;</span>
        <span class="gen-category comfort" id="dinnerCat">Comfort Food</span>
        <div class="gen-title" id="dinnerTitle">Tap below to solve the eternal question!</div>
        <div class="gen-desc" id="dinnerDesc">No more &ldquo;I don't know, what do you want?&rdquo;</div>
        <div class="gen-meta" id="dinnerMeta"></div>
      </div>
      <button class="gen-btn" onclick="spinDinner()">&#127860; Pick Again</button>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ PHOTO BOOTH PAGE ════ -->
  <div class="page" id="page-booth">

    <div class="gallery-label">&#128247; Valentine's Photo Booth &#128247;</div>

    <div class="booth-viewfinder glass" id="boothViewfinder">
      <video id="boothCamera" playsinline autoplay muted></video>
      <canvas id="boothCanvas"></canvas>
      <div class="booth-frame-overlay" id="boothFrameOverlay"></div>
    </div>

    <div class="booth-frames" id="boothFrames">
      <div class="booth-frame-opt active" onclick="setBoothFrame(0)">&#10084;&#65039; Hearts</div>
      <div class="booth-frame-opt" onclick="setBoothFrame(1)">&#128140; Love</div>
      <div class="booth-frame-opt" onclick="setBoothFrame(2)">&#10024; Sparkle</div>
      <div class="booth-frame-opt" onclick="setBoothFrame(3)">&#128293; Hot</div>
    </div>

    <div class="booth-controls" id="boothControls">
      <button class="booth-snap" id="boothSnap" onclick="takeBoothPhoto()">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="white"><circle cx="12" cy="13" r="4"/><path d="M20 7h-3.2L15 5H9L7.2 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z" fill="none" stroke="white" stroke-width="1.5"/></svg>
      </button>
    </div>
    <div class="booth-controls" id="boothActions" style="display:none">
      <button class="booth-action" onclick="saveBoothPhoto()">&#128190; Save Photo</button>
      <button class="booth-action" onclick="retakeBoothPhoto()">&#128247; Retake</button>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ TEXT ME WHEN PAGE ════ -->
  <div class="page" id="page-textme">

    <div class="gallery-label">&#128172; Text Me When... &#128172;</div>

    <a class="sms-card glass" href="sms:18034224114&body=Hey%20babe%2C%20I'm%20home%20safe%20%E2%9D%A4%EF%B8%8F">
      <div class="sms-emoji">&#127968;</div>
      <div class="sms-body">
        <div class="sms-label">You're home safe</div>
        <div class="sms-text">Hey babe, I'm home safe &#10084;&#65039;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=Missing%20you%20right%20now%20%F0%9F%92%95">
      <div class="sms-emoji">&#128149;</div>
      <div class="sms-body">
        <div class="sms-label">You miss him</div>
        <div class="sms-text">Missing you right now &#128149;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=Goodnight%20beautiful%2C%20sweet%20dreams%20%F0%9F%98%98">
      <div class="sms-emoji">&#127769;</div>
      <div class="sms-body">
        <div class="sms-label">Goodnight</div>
        <div class="sms-text">Goodnight beautiful, sweet dreams &#128536;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=I%20need%20a%20laugh%2C%20entertain%20me!%20%F0%9F%98%82">
      <div class="sms-emoji">&#128514;</div>
      <div class="sms-body">
        <div class="sms-label">You need a laugh</div>
        <div class="sms-text">I need a laugh, entertain me! &#128514;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=I%20need%20a%20hug%20ASAP%20%F0%9F%A4%97">
      <div class="sms-emoji">&#129303;</div>
      <div class="sms-body">
        <div class="sms-label">You need a hug</div>
        <div class="sms-text">I need a hug ASAP &#129303;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=Just%20thinking%20about%20you%20%E2%9D%A4%EF%B8%8F">
      <div class="sms-emoji">&#128173;</div>
      <div class="sms-body">
        <div class="sms-label">Thinking of him</div>
        <div class="sms-text">Just thinking about you &#10084;&#65039;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=Come%20home%20soon!%20Missing%20you%20%F0%9F%92%8B">
      <div class="sms-emoji">&#128139;</div>
      <div class="sms-body">
        <div class="sms-label">Come home</div>
        <div class="sms-text">Come home soon! Missing you &#128139;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=I%20love%20you%20so%20much%20%F0%9F%92%95">
      <div class="sms-emoji">&#128156;</div>
      <div class="sms-body">
        <div class="sms-label">Just because</div>
        <div class="sms-text">I love you so much &#128149;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=Can%20we%20have%20a%20date%20night%20soon%3F%20%F0%9F%92%91">
      <div class="sms-emoji">&#128145;</div>
      <div class="sms-body">
        <div class="sms-label">Date night request</div>
        <div class="sms-text">Can we have a date night soon? &#128145;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <a class="sms-card glass" href="sms:18034224114&body=You%20looked%20really%20good%20today%20%F0%9F%94%A5">
      <div class="sms-emoji">&#128293;</div>
      <div class="sms-body">
        <div class="sms-label">He looked good</div>
        <div class="sms-text">You looked really good today &#128293;</div>
      </div>
      <div class="sms-arrow">&#8250;</div>
    </a>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ WEEKLY CHALLENGE PAGE ════ -->
  <div class="page" id="page-challenge">

    <div class="gallery-label">&#127942; Weekly Couple Challenge &#127942;</div>

    <div class="challenge-card glass" id="challengeCard">
      <div class="challenge-inner" id="challengeInner">
        <span class="gen-icon" id="challengeIcon">&#127942;</span>
        <div class="gen-title" id="challengeTitle">Tap below to get this week's challenge!</div>
        <div class="gen-desc" id="challengeDesc">Fun ways to grow closer together</div>
      </div>
      <div class="challenge-check" id="challengeCheck" onclick="toggleChallengeComplete()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
      </div>
      <button class="gen-btn" onclick="newChallenge()" style="margin-top:18px">&#127922; New Challenge</button>
    </div>

    <div class="challenge-stats glass" id="challengeStats">
      <div id="challengeCount">0 challenges completed &#10084;&#65039;</div>
      <div class="challenge-bar"><div class="challenge-bar-fill" id="challengeBarFill"></div></div>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ GAMES PAGE ════ -->
  <div class="page" id="page-games">

    <div class="gallery-label">&#127922; Love Games &#127922;</div>

    <div class="game-switcher">
      <button class="game-switcher-btn active" onclick="switchGame('jumble')">&#128260; Word Jumble</button>
      <button class="game-switcher-btn" onclick="switchGame('wordsearch')">&#128270; Word Search</button>
      <button class="game-switcher-btn" onclick="switchGame('hptrivia')">&#9889; HP Trivia</button>
    </div>

    <!-- Word Jumble -->
    <div class="game-section active" id="game-jumble">
      <div class="jumble-card glass" id="jumbleCard" style="position:relative; overflow:hidden;">
        <div class="jumble-score" id="jumbleScore">&#10084;&#65039; Score: 0</div>
        <div class="jumble-scrambled" id="jumbleScrambled">???</div>
        <div class="jumble-hint" id="jumbleHint">Tap "New Word" to start!</div>
        <input class="jumble-input" id="jumbleInput" type="text" placeholder="Type your guess..." autocomplete="off" autocapitalize="characters" spellcheck="false">
        <div class="jumble-feedback" id="jumbleFeedback"></div>
        <div class="jumble-btns">
          <button class="jumble-btn jumble-btn-check" onclick="checkJumble()">&#10004;&#65039; Check</button>
          <button class="jumble-btn jumble-btn-skip" onclick="revealJumble()">&#128064; Give Up</button>
          <button class="jumble-btn jumble-btn-next" onclick="nextJumble()">&#10024; New Word</button>
        </div>
      </div>
    </div>

    <!-- Word Search -->
    <div class="game-section" id="game-wordsearch">
      <div class="ws-card glass" id="wsCard" style="position:relative; overflow:hidden;">
        <div class="ws-stats">
          <div class="ws-stat" id="wsFound">&#10084;&#65039; Found: 0 / 0</div>
          <div class="ws-stat" id="wsTimer">&#9201; 0:00</div>
        </div>
        <div class="ws-grid-wrap" id="wsGridWrap">
          <div class="ws-grid" id="wsGrid"></div>
        </div>
        <div class="ws-wordlist" id="wsWordList"></div>
        <div class="ws-complete-msg" id="wsCompleteMsg">&#127881; You found them all! &#127881;</div>
        <button class="ws-btn-new" onclick="newWordSearch()">&#10024; New Puzzle</button>
      </div>
    </div>

    <!-- Harry Potter Trivia -->
    <div class="game-section" id="game-hptrivia">
      <div class="hp-card glass" id="hpCard">
        <div class="hp-score" id="hpScore">&#9889; Score: 0 / 0</div>
        <div class="hp-qnum" id="hpQNum">&#129668; Tap "Next Question" to start!</div>
        <div class="hp-question" id="hpQuestion">Ready to test your wizarding knowledge?</div>
        <div class="hp-answers" id="hpAnswers">
          <button class="hp-answer disabled" style="opacity:.4">&#129668;</button>
          <button class="hp-answer disabled" style="opacity:.4">&#128166;</button>
          <button class="hp-answer disabled" style="opacity:.4">&#9889;</button>
          <button class="hp-answer disabled" style="opacity:.4">&#129417;</button>
        </div>
        <div class="hp-feedback" id="hpFeedback"></div>
        <div class="hp-btns">
          <button class="hp-btn-submit" id="hpSubmit" onclick="submitHP()" disabled>&#129668; Submit Answer</button>
          <button class="hp-btn-next" id="hpNext" onclick="nextHP()">&#10024; Next Question</button>
        </div>
        <div class="hp-streak" id="hpStreak"></div>
      </div>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- ════ MY PURSES PAGE ════ -->
  <div class="page" id="page-purses">

    <div class="gallery-label">&#128092; My Purse Collection &#128092;</div>
    <div class="purse-subtitle">From Brad with Love &#8212; All 48 beautiful purses for outfit planning and shopping reference!</div>
    <div class="purse-count" id="purseCount"></div>

    <div class="purse-grid" id="purseGrid"></div>

    <div class="purse-note">Perfect for choosing outfits and remembering what you have when shopping! &#128149;</div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

  <!-- Purse Lightbox -->
  <div class="purse-lightbox" id="purseLightbox">
    <button class="purse-lightbox-close" onclick="closePurseLB()">&#10005;</button>
    <button class="purse-lightbox-nav purse-lightbox-prev" onclick="navPurseLB(-1)">&#8249;</button>
    <button class="purse-lightbox-nav purse-lightbox-next" onclick="navPurseLB(1)">&#8250;</button>
    <img class="purse-lightbox-img" id="purseLBImg" src="" alt="">
    <div class="purse-lightbox-caption" id="purseLBCaption"></div>
    <div class="purse-lightbox-counter" id="purseLBCounter"></div>
  </div>

  <!-- ════ ABOUT THE AUTHOR PAGE ════ -->
  <div class="page" id="page-about">

    <div class="gallery-label">&#10084;&#65039; About the Author &#10084;&#65039;</div>

    <div class="about-card glass">
      <div class="about-photo-wrap">
        <img class="about-photo" src="/static/brad-photo.jpg" alt="Brad">
        <div class="about-photo-shine"></div>
        <span class="about-sparkle">&#10024;</span>
        <span class="about-sparkle">&#10024;</span>
        <span class="about-sparkle">&#10024;</span>
        <span class="about-sparkle">&#10024;</span>
        <span class="about-sparkle">&#10024;</span>
      </div>
      <div class="about-name">Brad Valdes</div>
      <div class="about-title-sub">Husband, Father, Hopeless Romantic</div>
      <div class="about-text">
        <p>This app was lovingly crafted by your incredibly handsome, devoted, and romantic husband, Brad.</p>
        <p>Why did he make this? Because you deserve to know how much you&#8217;re loved every single day.</p>
        <p>Brad&#8217;s credentials include: Being hopelessly in love with Katy, making her laugh daily, attempting to cook (with varying success), and being the luckiest man alive.</p>
        <p>His life&#8217;s mission: Making sure Katy never forgets she&#8217;s the most amazing woman in the world.</p>
        <p>Professional skills: Building apps, planning romantic surprises, and being ridiculously good-looking (his words, not mine&#8230; okay, his words).</p>
        <p>Side note: He&#8217;s also incredibly humble. &#128527;</p>
      </div>
      <div class="about-sig">Made with &#10084;&#65039; by Brad</div>
    </div>

    <div class="footer">
      Made with &#10084;&#65039; for the love of my life
    </div>

  </div>

</div>

<audio id="bgMusic" preload="auto">
  <source src="/static/my-home.mp3" type="audio/mpeg">
</audio>

<!-- Daily reminder -->
<div class="daily-overlay" id="dailyOverlay">
  <div class="daily-card">
    <span class="daily-icon">&#128149;</span>
    <p class="daily-text">Remember, your husband loves you dearly&#8212;even when it doesn&#8217;t show &#10084;&#65039;</p>
    <button class="daily-dismiss" onclick="dismissDaily()">I know &#128149;</button>
  </div>
</div>

<!-- Tap-to-play overlay -->
<div class="tap-overlay" id="tapOverlay">
  <div class="tap-content">
    <div class="tap-heart">&#128157;</div>
    <div class="tap-text">Tap anywhere to begin</div>
    <div class="tap-sub">A Valentine's surprise for you &#10084;&#65039;</div>
  </div>
</div>

<script>
  // ── Floating Hearts ──
  const heartsContainer = document.getElementById("heartsContainer");
  const heartChars = ["\u2764\uFE0F", "\uD83D\uDC95", "\uD83D\uDC97", "\uD83D\uDC96", "\uD83D\uDC9D", "\uD83E\uDE77", "\u2665"];

  function spawnHeart() {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.textContent = heartChars[Math.floor(Math.random() * heartChars.length)];
    heart.style.left = Math.random() * 100 + "%";
    heart.style.fontSize = (14 + Math.random() * 18) + "px";
    heart.style.animationDuration = (8 + Math.random() * 12) + "s";
    heart.style.animationDelay = Math.random() * 2 + "s";
    heartsContainer.appendChild(heart);
    setTimeout(() => heart.remove(), 22000);
  }

  for (let i = 0; i < 12; i++) setTimeout(spawnHeart, i * 400);
  setInterval(spawnHeart, 1800);

  // ── Page Navigation ──
  const pageNames = ["home", "sexy", "coupons", "hunt", "poems", "fascinate", "dates", "compliments", "dinner", "booth", "textme", "challenge", "games", "purses", "about"];
  let musicWasPlaying = false;
  function showPage(name) {
    const prevPage = pageNames.find(p => document.getElementById("page-" + p).classList.contains("active"));
    document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
    document.getElementById("page-" + name).classList.add("active");
    document.querySelectorAll(".nav-tab").forEach((t, i) => {
      t.classList.toggle("active", pageNames[i] === name);
    });
    window.scrollTo({ top: 0, behavior: "smooth" });

    const vid1 = document.getElementById("fascinateVideo");
    const vid2 = document.getElementById("fascinateVideo2");
    const overlay = document.getElementById("videoPlayOverlay");
    const container2 = document.getElementById("videoContainer2");
    if (name === "fascinate") {
      // Entering video tab: pause music, autoplay first video
      musicWasPlaying = isPlaying;
      if (isPlaying) { audio.pause(); setPausedUI(); }
      vid1.currentTime = 0;
      vid2.currentTime = 0;
      vid2.pause();
      container2.style.display = "none";
      vid1.play().then(() => { overlay.classList.add("hidden"); }).catch(() => { overlay.classList.remove("hidden"); });
    } else if (prevPage === "fascinate") {
      // Leaving video tab: stop both videos, resume music
      vid1.pause(); vid1.currentTime = 0;
      vid2.pause(); vid2.currentTime = 0;
      container2.style.display = "none";
      overlay.classList.remove("hidden");
      if (musicWasPlaying) { audio.play().then(() => setPlayingUI()).catch(() => {}); }
    }

    // Photo booth camera management
    if (name === "booth") { startBoothCamera(); }
    else if (prevPage === "booth") { stopBoothCamera(); retakeBoothPhoto(); }
  }

  // ── Photo Gallery (Swipeable) ──
  const track = document.getElementById("galleryTrack");
  const dots = document.querySelectorAll(".gallery-dot");
  const totalSlides = 4;
  let currentSlide = 0;
  let startX = 0, currentX = 0, isDragging = false;

  function updateGallery(animate = true) {
    if (!animate) track.classList.add("dragging");
    else track.classList.remove("dragging");
    track.style.transform = `translateX(-${currentSlide * 100}%)`;
    dots.forEach((d, i) => d.classList.toggle("active", i === currentSlide));
  }

  function nextSlide() {
    currentSlide = (currentSlide + 1) % totalSlides;
    updateGallery();
  }

  function prevSlide() {
    currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
    updateGallery();
  }

  function goToSlide(n) {
    currentSlide = n;
    updateGallery();
  }

  const gallery = document.getElementById("gallery");

  gallery.addEventListener("touchstart", (e) => {
    startX = e.touches[0].clientX;
    isDragging = true;
    track.classList.add("dragging");
  }, { passive: true });

  gallery.addEventListener("touchmove", (e) => {
    if (!isDragging) return;
    currentX = e.touches[0].clientX;
    const diff = currentX - startX;
    const offset = -(currentSlide * gallery.offsetWidth) + diff;
    track.style.transform = `translateX(${offset}px)`;
  }, { passive: true });

  gallery.addEventListener("touchend", () => {
    if (!isDragging) return;
    isDragging = false;
    const diff = currentX - startX;
    if (Math.abs(diff) > 50) {
      if (diff < 0 && currentSlide < totalSlides - 1) currentSlide++;
      else if (diff > 0 && currentSlide > 0) currentSlide--;
    }
    currentX = 0;
    updateGallery(true);
  });

  let galleryTimer = setInterval(nextSlide, 5000);
  gallery.addEventListener("touchstart", () => { clearInterval(galleryTimer); }, { passive: true });
  gallery.addEventListener("touchend", () => {
    galleryTimer = setInterval(nextSlide, 5000);
  });

  // ── Sexy Gallery (Swipeable) ──
  const sexyTrack = document.getElementById("sexyTrack");
  const sexyGallery = document.getElementById("sexyGallery");
  const sexyDotsContainer = document.getElementById("sexyDots");
  const totalSexy = 11;
  let currentSexy = 0;
  let sexyStartX = 0, sexyCurrentX = 0, sexyDragging = false;

  // Build sexy dots
  for (let i = 0; i < totalSexy; i++) {
    const dot = document.createElement("div");
    dot.className = "gallery-dot" + (i === 0 ? " active" : "");
    dot.onclick = () => goToSexy(i);
    sexyDotsContainer.appendChild(dot);
  }

  function updateSexyGallery(animate = true) {
    if (!animate) sexyTrack.classList.add("dragging");
    else sexyTrack.classList.remove("dragging");
    sexyTrack.style.transform = `translateX(-${currentSexy * 100}%)`;
    sexyDotsContainer.querySelectorAll(".gallery-dot").forEach((d, i) => {
      d.classList.toggle("active", i === currentSexy);
    });
  }

  function nextSexy() {
    currentSexy = (currentSexy + 1) % totalSexy;
    updateSexyGallery();
  }

  function prevSexy() {
    currentSexy = (currentSexy - 1 + totalSexy) % totalSexy;
    updateSexyGallery();
  }

  function goToSexy(n) {
    currentSexy = n;
    updateSexyGallery();
  }

  sexyGallery.addEventListener("touchstart", (e) => {
    sexyStartX = e.touches[0].clientX;
    sexyDragging = true;
    sexyTrack.classList.add("dragging");
  }, { passive: true });

  sexyGallery.addEventListener("touchmove", (e) => {
    if (!sexyDragging) return;
    sexyCurrentX = e.touches[0].clientX;
    const diff = sexyCurrentX - sexyStartX;
    const offset = -(currentSexy * sexyGallery.offsetWidth) + diff;
    sexyTrack.style.transform = `translateX(${offset}px)`;
  }, { passive: true });

  sexyGallery.addEventListener("touchend", () => {
    if (!sexyDragging) return;
    sexyDragging = false;
    const diff = sexyCurrentX - sexyStartX;
    if (Math.abs(diff) > 50) {
      if (diff < 0 && currentSexy < totalSexy - 1) currentSexy++;
      else if (diff > 0 && currentSexy > 0) currentSexy--;
    }
    sexyCurrentX = 0;
    updateSexyGallery(true);
  });

  let sexyTimer = setInterval(nextSexy, 5000);
  sexyGallery.addEventListener("touchstart", () => { clearInterval(sexyTimer); }, { passive: true });
  sexyGallery.addEventListener("touchend", () => {
    sexyTimer = setInterval(nextSexy, 5000);
  });

  // ── Poem Viewer (Swipeable) ──
  const poemTrack = document.getElementById("poemTrack");
  const poemViewer = document.getElementById("poemViewer");
  const poemCounter = document.getElementById("poemCounter");
  const poemPrev = document.getElementById("poemPrev");
  const poemNext = document.getElementById("poemNext");
  const poemDotsContainer = document.getElementById("poemDots");
  const totalPoems = 10;
  let currentPoem = 0;
  let poemStartX = 0, poemCurrentX = 0, poemDragging = false;

  // Build poem dots
  for (let i = 0; i < totalPoems; i++) {
    const dot = document.createElement("div");
    dot.className = "poem-dot" + (i === 0 ? " active" : "");
    dot.onclick = () => goToPoem(i);
    poemDotsContainer.appendChild(dot);
  }

  function updatePoemUI() {
    poemTrack.classList.remove("dragging");
    poemTrack.style.transform = `translateX(-${currentPoem * 100}%)`;
    poemCounter.textContent = `${currentPoem + 1} / ${totalPoems}`;
    poemPrev.disabled = currentPoem === 0;
    poemNext.disabled = currentPoem === totalPoems - 1;
    poemDotsContainer.querySelectorAll(".poem-dot").forEach((d, i) => {
      d.classList.toggle("active", i === currentPoem);
    });
  }

  function nextPoem() {
    if (currentPoem < totalPoems - 1) { currentPoem++; updatePoemUI(); }
  }

  function prevPoem() {
    if (currentPoem > 0) { currentPoem--; updatePoemUI(); }
  }

  function goToPoem(n) {
    currentPoem = n;
    updatePoemUI();
  }

  // Poem touch swipe
  poemViewer.addEventListener("touchstart", (e) => {
    poemStartX = e.touches[0].clientX;
    poemDragging = true;
    poemTrack.classList.add("dragging");
  }, { passive: true });

  poemViewer.addEventListener("touchmove", (e) => {
    if (!poemDragging) return;
    poemCurrentX = e.touches[0].clientX;
    const diff = poemCurrentX - poemStartX;
    const offset = -(currentPoem * poemViewer.offsetWidth) + diff;
    poemTrack.style.transform = `translateX(${offset}px)`;
  }, { passive: true });

  poemViewer.addEventListener("touchend", () => {
    if (!poemDragging) return;
    poemDragging = false;
    const diff = poemCurrentX - poemStartX;
    if (Math.abs(diff) > 50) {
      if (diff < 0 && currentPoem < totalPoems - 1) currentPoem++;
      else if (diff > 0 && currentPoem > 0) currentPoem--;
    }
    poemCurrentX = 0;
    updatePoemUI();
  });

  // ── Music Player (Playlist) ──
  const playlist = [
    { src: "/static/my-home.mp3", title: "My Home", artist: "Myles Smith" },
    { src: "/static/a-thousand-years.mp3", title: "A Thousand Years", artist: "Christina Perri" },
    { src: "/static/too-sweet.mp3", title: "Too Sweet", artist: "Hozier" },
    { src: "/static/forever-and-always.mp3", title: "Forever and for Always", artist: "Shania Twain" },
    { src: "/static/never-gonna-give-you-up.mp3", title: "Never Gonna Give You Up", artist: "Rick Astley" },
    { src: "/static/king-of-wishful-thinking.mp3", title: "King of Wishful Thinking", artist: "Go West" },
    { src: "/static/whatever-you-like.mp3", title: "Whatever You Like", artist: "T.I." },
    { src: "/static/unchained-melody.mp3", title: "Unchained Melody", artist: "The Righteous Brothers" },
    { src: "/static/suspicious-minds.mp3", title: "Suspicious Minds", artist: "Elvis Presley" }
  ];
  // Shuffle playlist on each load (Fisher-Yates)
  for (let i = playlist.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [playlist[i], playlist[j]] = [playlist[j], playlist[i]];
  }
  let currentTrack = 0;

  const audio = document.getElementById("bgMusic");
  const musicBtn = document.getElementById("musicBtn");
  const playIcon = document.getElementById("playIcon");
  const pauseIcon = document.getElementById("pauseIcon");
  const progressFill = document.getElementById("progressFill");
  const currentTimeEl = document.getElementById("currentTime");
  const totalTimeEl = document.getElementById("totalTime");
  const visualizer = document.getElementById("visualizer");
  const tapOverlay = document.getElementById("tapOverlay");
  const musicTitle = document.getElementById("musicTitle");
  const musicArtist = document.getElementById("musicArtist");
  let isPlaying = false;

  // Set initial track from shuffled playlist
  audio.src = playlist[0].src;

  function updateTrackUI() {
    const t = playlist[currentTrack];
    musicTitle.innerHTML = t.title + " &#8212; " + t.artist + ' <span class="music-note">&#9834;</span>';
    musicArtist.innerHTML = "Song " + (currentTrack + 1) + " of " + playlist.length + " &#128149;";
  }

  updateTrackUI(); // Set initial UI from shuffled playlist

  function loadTrack(index, autoplay) {
    currentTrack = index;
    audio.src = playlist[index].src;
    audio.load();
    updateTrackUI();
    if (autoplay) {
      audio.play().then(() => setPlayingUI()).catch(() => {});
    }
  }

  function formatTime(s) {
    if (isNaN(s) || s < 0) return "0:00";
    const m = Math.floor(s / 60);
    const sec = Math.floor(s % 60);
    return m + ":" + (sec < 10 ? "0" : "") + sec;
  }

  function setPlayingUI() {
    isPlaying = true;
    playIcon.style.display = "none";
    pauseIcon.style.display = "";
    musicBtn.classList.add("playing");
    visualizer.classList.remove("paused");
    tapOverlay.classList.add("hidden");
  }

  function setPausedUI() {
    isPlaying = false;
    playIcon.style.display = "";
    pauseIcon.style.display = "none";
    musicBtn.classList.remove("playing");
    visualizer.classList.add("paused");
  }

  tapOverlay.addEventListener("click", () => {
    audio.play().then(() => setPlayingUI()).catch(() => {});
    tapOverlay.classList.add("hidden");
  });

  function toggleMusic() {
    if (isPlaying) {
      audio.pause();
      setPausedUI();
    } else {
      audio.play().then(() => setPlayingUI()).catch(() => {});
    }
  }

  function skipTrack() {
    const next = (currentTrack + 1) % playlist.length;
    loadTrack(next, isPlaying || !audio.paused);
  }

  function seekMusic(e) {
    if (!audio.duration) return;
    const rect = e.currentTarget.getBoundingClientRect();
    const pct = (e.clientX - rect.left) / rect.width;
    audio.currentTime = pct * audio.duration;
  }

  audio.addEventListener("timeupdate", () => {
    if (audio.duration) {
      progressFill.style.width = (audio.currentTime / audio.duration * 100) + "%";
      currentTimeEl.textContent = formatTime(audio.currentTime);
    }
  });

  audio.addEventListener("loadedmetadata", () => {
    totalTimeEl.textContent = formatTime(audio.duration);
  });

  // When a song ends, play the next one (loop back to first after last)
  audio.addEventListener("ended", () => {
    const next = (currentTrack + 1) % playlist.length;
    loadTrack(next, true);
  });

  // ── Love Coupons ──
  const COUPON_KEY = "valentine-coupons-redeemed";

  function loadCoupons() {
    try {
      const saved = JSON.parse(localStorage.getItem(COUPON_KEY) || "[]");
      saved.forEach(id => {
        const card = document.getElementById("coupon-" + id);
        if (card) card.classList.add("redeemed");
      });
    } catch(e) {}
  }

  function saveCoupons() {
    const redeemed = [];
    document.querySelectorAll(".coupon-card.redeemed").forEach(card => {
      redeemed.push(parseInt(card.id.replace("coupon-", "")));
    });
    localStorage.setItem(COUPON_KEY, JSON.stringify(redeemed));
  }

  function toggleCoupon(id) {
    const card = document.getElementById("coupon-" + id);
    card.classList.toggle("redeemed");
    saveCoupons();
  }

  loadCoupons();

  // ── Scavenger Hunt ──
  const HUNT_KEY = "valentine-hunt-solved";
  const TOTAL_CLUES = 8;

  function loadHunt() {
    try {
      const saved = JSON.parse(localStorage.getItem(HUNT_KEY) || "[]");
      saved.forEach(id => {
        const clue = document.getElementById("hunt-" + id);
        if (clue) clue.classList.add("solved");
      });
      // Unlock clues based on solved state
      for (let i = 0; i < TOTAL_CLUES; i++) {
        const clue = document.getElementById("hunt-" + i);
        if (i === 0 || document.getElementById("hunt-" + (i - 1)).classList.contains("solved")) {
          clue.classList.remove("locked");
          const lock = clue.querySelector(".hunt-clue-lock");
          if (lock) lock.style.display = "none";
        }
      }
      updateHuntUI();
    } catch(e) {}
  }

  function saveHunt() {
    const solved = [];
    document.querySelectorAll(".hunt-clue.solved").forEach(el => {
      solved.push(parseInt(el.id.replace("hunt-", "")));
    });
    localStorage.setItem(HUNT_KEY, JSON.stringify(solved));
  }

  function updateHuntUI() {
    const solvedCount = document.querySelectorAll(".hunt-clue.solved").length;
    const progress = document.getElementById("huntProgress");
    const fill = document.getElementById("huntProgressFill");
    const complete = document.getElementById("huntComplete");

    if (solvedCount >= TOTAL_CLUES) {
      progress.textContent = "All 8 clues solved!";
      fill.style.width = "100%";
      complete.classList.add("visible");
    } else {
      progress.textContent = `Clue ${solvedCount + 1} of ${TOTAL_CLUES}`;
      fill.style.width = (solvedCount / TOTAL_CLUES * 100) + "%";
      complete.classList.remove("visible");
    }
  }

  function solveClue(id) {
    const clue = document.getElementById("hunt-" + id);
    if (clue.classList.contains("locked") || clue.classList.contains("solved")) return;

    clue.classList.add("solved");

    // Unlock next clue
    const next = document.getElementById("hunt-" + (id + 1));
    if (next) {
      next.classList.remove("locked");
      const lock = next.querySelector(".hunt-clue-lock");
      if (lock) lock.style.display = "none";
    }

    saveHunt();
    updateHuntUI();
  }

  loadHunt();

  // ── Love Reminder (every launch) ──
  function showDailyReminder() {
    setTimeout(() => {
      document.getElementById("dailyOverlay").classList.add("visible");
    }, 1500);
  }

  function dismissDaily() {
    document.getElementById("dailyOverlay").classList.remove("visible");
  }

  showDailyReminder();

  // ── You Fascinate Me Videos (sequential playback) ──
  const fascinateVid1 = document.getElementById("fascinateVideo");
  const fascinateVid2 = document.getElementById("fascinateVideo2");
  const fascinateContainer2 = document.getElementById("videoContainer2");

  // When first video ends, show and play second video
  fascinateVid1.addEventListener("ended", () => {
    fascinateContainer2.style.display = "block";
    fascinateVid2.currentTime = 0;
    fascinateVid2.play().catch(() => {});
  });

  // When second video ends, loop back to first
  fascinateVid2.addEventListener("ended", () => {
    fascinateVid2.pause();
    fascinateContainer2.style.display = "none";
    fascinateVid1.currentTime = 0;
    fascinateVid1.play().catch(() => {});
  });

  function toggleFascinateVideo() {
    const overlay = document.getElementById("videoPlayOverlay");
    // Determine which video is currently active
    const activeVid = fascinateContainer2.style.display !== "none" ? fascinateVid2 : fascinateVid1;
    if (activeVid.paused) {
      activeVid.play().then(() => { overlay.classList.add("hidden"); }).catch(() => {});
    } else {
      activeVid.pause();
      overlay.classList.remove("hidden");
    }
  }

  fascinateVid1.addEventListener("click", toggleFascinateVideo);
  fascinateVid2.addEventListener("click", toggleFascinateVideo);

  // ── Date Night Generator ──
  const dateIdeas = [
    { icon:"\uD83C\uDF37", cat:"romantic", title:"Sunset Picnic", desc:"Pack wine, cheese, and a blanket. Find a spot with a view and watch the sun go down together.", meta:"\uD83D\uDCB0 $20\u201340 \u00B7 \u23F0 2\u20133 hrs" },
    { icon:"\uD83C\uDFB6", cat:"romantic", title:"Live Music Night", desc:"Find a local bar or venue with live music. Hold hands and sway to the songs.", meta:"\uD83D\uDCB0 $30\u201360 \u00B7 \u23F0 3+ hrs" },
    { icon:"\uD83D\uDEB6", cat:"adventurous", title:"Night Hike", desc:"Pick a trail you both love and do it under the stars. Bring flashlights and hot cocoa.", meta:"\uD83D\uDCB0 Free \u00B7 \u23F0 2\u20133 hrs" },
    { icon:"\uD83C\uDFA8", cat:"fun", title:"Paint & Sip at Home", desc:"Grab two canvases, some paint, and a bottle of wine. Paint each other\u2019s portraits (no skills required).", meta:"\uD83D\uDCB0 $20\u201330 \u00B7 \u23F0 2 hrs" },
    { icon:"\uD83C\uDF7D\uFE0F", cat:"fancy", title:"Fancy Restaurant Date", desc:"Dress up, make reservations at that place you\u2019ve been meaning to try, and savor every course.", meta:"\uD83D\uDCB0 $80\u2013150 \u00B7 \u23F0 2\u20133 hrs" },
    { icon:"\uD83C\uDFAC", cat:"cozy", title:"Movie Marathon", desc:"Pick a trilogy or series. Make a blanket fort, pop popcorn, and binge together all night.", meta:"\uD83D\uDCB0 Free \u00B7 \u23F0 4+ hrs" },
    { icon:"\uD83E\uDDD6", cat:"cozy", title:"Spa Night at Home", desc:"Face masks, candles, massage oils, and soft music. Take turns pampering each other.", meta:"\uD83D\uDCB0 $15\u201330 \u00B7 \u23F0 2 hrs" },
    { icon:"\uD83C\uDF73", cat:"athome", title:"Cook a New Recipe Together", desc:"Find something neither of you has made before. Make a mess in the kitchen and love every minute.", meta:"\uD83D\uDCB0 $20\u201340 \u00B7 \u23F0 2 hrs" },
    { icon:"\u2B50", cat:"adventurous", title:"Stargazing", desc:"Drive somewhere dark, lay out blankets, and try to find constellations. Bring snacks and each other.", meta:"\uD83D\uDCB0 Free \u00B7 \u23F0 2+ hrs" },
    { icon:"\uD83C\uDFB3", cat:"fun", title:"Bowling Night", desc:"Rent some shoes, throw some gutter balls, and laugh until your sides hurt. Loser buys ice cream.", meta:"\uD83D\uDCB0 $25\u201345 \u00B7 \u23F0 2 hrs" },
    { icon:"\uD83D\uDCD6", cat:"cozy", title:"Bookstore & Coffee", desc:"Browse a bookstore together, pick a book for each other, then read side by side at a coffee shop.", meta:"\uD83D\uDCB0 $20\u201340 \u00B7 \u23F0 2\u20133 hrs" },
    { icon:"\uD83C\uDF77", cat:"romantic", title:"Wine Tasting", desc:"Visit a local winery or set up a tasting at home with 4\u20135 different bottles. Rate them together.", meta:"\uD83D\uDCB0 $30\u201370 \u00B7 \u23F0 2\u20133 hrs" },
    { icon:"\uD83D\uDE97", cat:"adventurous", title:"Spontaneous Road Trip", desc:"Pick a direction and drive. Stop at whatever looks interesting. The journey IS the date.", meta:"\uD83D\uDCB0 $30\u201360 \u00B7 \u23F0 Half day" },
    { icon:"\uD83C\uDFAE", cat:"fun", title:"Game Night", desc:"Break out the board games or video games. Get competitive. Trash talk encouraged.", meta:"\uD83D\uDCB0 Free \u00B7 \u23F0 2\u20133 hrs" },
    { icon:"\uD83D\uDC83", cat:"fancy", title:"Dancing", desc:"Find a salsa, swing, or ballroom class for beginners. Or just dance in the living room.", meta:"\uD83D\uDCB0 Free\u2013$40 \u00B7 \u23F0 2 hrs" },
    { icon:"\uD83C\uDF1F", cat:"romantic", title:"Recreate Your First Date", desc:"Go back to where it all started. Wear what you wore (or try to). Relive the magic.", meta:"\uD83D\uDCB0 Varies \u00B7 \u23F0 3+ hrs" },
    { icon:"\uD83C\uDF70", cat:"athome", title:"Baking Challenge", desc:"Each person picks a dessert to bake. Judge each other\u2019s creations. Everyone wins because\u2026 dessert.", meta:"\uD83D\uDCB0 $15\u201325 \u00B7 \u23F0 2\u20133 hrs" },
    { icon:"\uD83D\uDDBC\uFE0F", cat:"fun", title:"Art Gallery or Museum", desc:"Wander through exhibits. Make up stories about the art. Pretend to be cultured.", meta:"\uD83D\uDCB0 $10\u201330 \u00B7 \u23F0 2\u20133 hrs" },
    { icon:"\uD83C\uDF1C", cat:"romantic", title:"Rooftop Drinks", desc:"Find a rooftop bar with a view. Order cocktails and soak in the city lights together.", meta:"\uD83D\uDCB0 $30\u201360 \u00B7 \u23F0 2 hrs" },
    { icon:"\uD83C\uDFD5\uFE0F", cat:"adventurous", title:"Backyard Camping", desc:"Set up a tent in the yard. Make s\u2019mores, tell stories, sleep under the stars (or retreat inside at 2am).", meta:"\uD83D\uDCB0 Free \u00B7 \u23F0 All night" },
    { icon:"\uD83D\uDCF8", cat:"fun", title:"Photo Walk", desc:"Grab your phones and walk around town photographing anything beautiful. Compare shots over dinner.", meta:"\uD83D\uDCB0 Free \u00B7 \u23F0 2 hrs" },
    { icon:"\uD83E\uDD42", cat:"fancy", title:"Cocktail Making Class", desc:"Learn to make fancy drinks together. Shake, stir, and taste-test your creations.", meta:"\uD83D\uDCB0 $40\u201380 \u00B7 \u23F0 2 hrs" },
    { icon:"\uD83D\uDEC1", cat:"cozy", title:"Bubble Bath for Two", desc:"Candles, bubbles, wine, and nowhere to be. Just the two of you.", meta:"\uD83D\uDCB0 $10 \u00B7 \u23F0 1+ hrs" },
    { icon:"\uD83C\uDF89", cat:"fun", title:"Karaoke Night", desc:"Belt out your favorite songs at a karaoke bar or at home. Duets mandatory.", meta:"\uD83D\uDCB0 $15\u201340 \u00B7 \u23F0 2\u20133 hrs" }
  ];
  let lastDateIdx = -1;

  function spinDate() {
    let idx;
    do { idx = Math.floor(Math.random() * dateIdeas.length); } while (idx === lastDateIdx);
    lastDateIdx = idx;
    const d = dateIdeas[idx];
    const inner = document.getElementById("dateInner");
    inner.classList.add("switching");
    setTimeout(() => {
      document.getElementById("dateIcon").textContent = d.icon;
      const catEl = document.getElementById("dateCat");
      catEl.className = "gen-category " + d.cat;
      catEl.textContent = d.cat === "athome" ? "At Home" : d.cat.charAt(0).toUpperCase() + d.cat.slice(1);
      document.getElementById("dateTitle").textContent = d.title;
      document.getElementById("dateDesc").textContent = d.desc;
      document.getElementById("dateMeta").textContent = d.meta;
      inner.classList.remove("switching");
    }, 350);
  }

  // ── Compliments for Katy ──
  const compliments = [
    { cat:"romantic", text:"The way you love our family takes my breath away. You are the heart of everything good in our home." },
    { cat:"sweet", text:"Your smile is still the most beautiful thing I\u2019ve ever seen. After all these years, it still stops me in my tracks." },
    { cat:"sexy", text:"You have no idea how gorgeous you are. I look at you and wonder how I got so lucky." },
    { cat:"funny", text:"You\u2019re the only person who can make me laugh so hard I forget what I was mad about. That\u2019s a superpower." },
    { cat:"sweet", text:"You make even the ordinary days feel special. Just being near you makes everything better." },
    { cat:"romantic", text:"I fall more in love with you every single day. That\u2019s not a clich\u00E9\u2014it\u2019s my actual life." },
    { cat:"sexy", text:"The way you look at me from across the room? Yeah, that still does things to me." },
    { cat:"sweet", text:"You are the strongest woman I know. The way you handle everything with grace inspires me daily." },
    { cat:"funny", text:"Your cooking is incredible, your patience is legendary, and your eye-roll game is absolutely world-class." },
    { cat:"romantic", text:"I would choose you in every lifetime, every universe, every version of reality. Always you." },
    { cat:"sweet", text:"Our kids are amazing because of you. You\u2019re the best mother they could ever have." },
    { cat:"sexy", text:"You\u2019re like fine wine, Katy\u2014you just keep getting better and more irresistible with time." },
    { cat:"funny", text:"You tolerate my nonsense with remarkable grace. That alone qualifies you for sainthood." },
    { cat:"romantic", text:"Coming home to you is my favorite part of every day. You are my home." },
    { cat:"sweet", text:"Your heart is so big it amazes me. The way you care about others is one of the things I love most about you." },
    { cat:"sexy", text:"That outfit you wore last time we went out? I\u2019m still thinking about it. Just saying." },
    { cat:"funny", text:"You\u2019re basically a superhero. Your only weakness is Target. And that\u2019s very relatable." },
    { cat:"romantic", text:"You make me want to be a better man. Every day, you inspire me to try harder." },
    { cat:"sweet", text:"Your laugh is my favorite sound in the entire world. I\u2019d do anything to hear it." },
    { cat:"sexy", text:"I don\u2019t tell you enough how attractive you are. Katy, you are absolutely stunning." },
    { cat:"romantic", text:"Thank you for being my partner, my best friend, and the love of my life. I don\u2019t deserve you, but I\u2019m so grateful." },
    { cat:"sweet", text:"The way you light up when you talk about something you love\u2014I could watch that forever." },
    { cat:"funny", text:"You manage our household, our kids, and me\u2014and somehow make it look easy. You\u2019re basically a CEO." },
    { cat:"sexy", text:"When you walk into a room, you own it. Every head turns, and I get to say \u2018that\u2019s my wife.\u2019" },
    { cat:"romantic", text:"I look at our life together and I\u2019m overwhelmed with gratitude. You\u2019ve given me everything I\u2019ve ever wanted." },
    { cat:"sweet", text:"You make the world a softer, kinder place just by being in it. That\u2019s your gift." },
    { cat:"funny", text:"You\u2019re the reason I still have clean clothes and a will to live. I\u2019m only half joking." },
    { cat:"sexy", text:"Every time I see you get dressed up, I have to remind myself to breathe. You\u2019re that beautiful." },
    { cat:"romantic", text:"My favorite place in the entire world is right next to you. Nowhere else even comes close." },
    { cat:"sweet", text:"The way you tuck the kids in, the way you remember every little detail\u2014you are pure magic, Katy." },
    { cat:"sexy", text:"Honestly? You fascinate me. In every way. And you always will." },
    { cat:"funny", text:"If loving you is wrong, I don\u2019t want to be right. Also, please don\u2019t make me sleep on the couch." }
  ];
  let lastCompIdx = -1;

  function newCompliment() {
    let idx;
    do { idx = Math.floor(Math.random() * compliments.length); } while (idx === lastCompIdx);
    lastCompIdx = idx;
    const c = compliments[idx];
    const textEl = document.getElementById("complimentText");
    const catEl = document.getElementById("complimentCat");
    textEl.classList.add("switching");
    // Burst hearts
    const card = document.getElementById("complimentCard");
    for (let i = 0; i < 6; i++) {
      const h = document.createElement("span");
      h.className = "compliment-burst";
      h.textContent = ["\u2764\uFE0F","\uD83D\uDC95","\uD83D\uDC96","\uD83D\uDC97","\uD83E\uDE77"][Math.floor(Math.random()*5)];
      h.style.left = (30 + Math.random()*40) + "%";
      h.style.top = (30 + Math.random()*30) + "%";
      h.style.setProperty("--bx", (Math.random()*120-60)+"px");
      h.style.setProperty("--by", (Math.random()*-100-20)+"px");
      card.appendChild(h);
      setTimeout(() => h.remove(), 900);
    }
    setTimeout(() => {
      catEl.className = "gen-category " + c.cat;
      catEl.textContent = c.cat.charAt(0).toUpperCase() + c.cat.slice(1);
      textEl.textContent = "\u201C" + c.text + "\u201D";
      textEl.classList.remove("switching");
    }, 350);
  }

  // ── What's for Dinner Generator ──
  const dinnerIdeas = [
    { icon:"\uD83C\uDF5D", cat:"quick", title:"Pasta Aglio e Olio", desc:"Simple, fast, and absolutely delicious. Garlic, olive oil, chili flakes, and spaghetti.", meta:"Quick & Easy \u00B7 30 min" },
    { icon:"\uD83E\uDD69", cat:"fancy", title:"Steak & Roasted Veggies", desc:"Sear a perfect steak, roast some asparagus and potatoes. Open a nice red wine.", meta:"Fancy Night In \u00B7 45 min" },
    { icon:"\uD83C\uDF2E", cat:"fun", title:"Taco Tuesday (Any Day)", desc:"Set up a taco bar with all the fixings. Let everyone build their own. Margaritas optional (but recommended).", meta:"Fun & Easy \u00B7 35 min" },
    { icon:"\uD83C\uDF72", cat:"comfort", title:"Homemade Chicken Soup", desc:"Soul-warming, hug-in-a-bowl comfort. Perfect for when you need something cozy.", meta:"Comfort Food \u00B7 1 hr" },
    { icon:"\uD83E\uDD57", cat:"healthy", title:"Big Mediterranean Salad", desc:"Greens, feta, olives, cucumbers, chickpeas, and a lemon vinaigrette. Light but satisfying.", meta:"Healthy \u00B7 20 min" },
    { icon:"\uD83C\uDF55", cat:"takeout", title:"Pizza Night (Delivered)", desc:"Nobody feels like cooking. Order from your favorite spot. Zero guilt, maximum comfort.", meta:"Takeout \u00B7 0 effort" },
    { icon:"\uD83C\uDF5B", cat:"comfort", title:"Mac & Cheese (From Scratch)", desc:"Creamy, cheesy, baked until bubbly. Add bacon bits if you\u2019re feeling wild.", meta:"Comfort Food \u00B7 50 min" },
    { icon:"\uD83C\uDF63", cat:"takeout", title:"Sushi Takeout", desc:"Treat yourselves to a sushi platter. Edamame, rolls, and maybe some sake.", meta:"Takeout \u00B7 0 effort" },
    { icon:"\uD83E\uDD6A", cat:"quick", title:"Gourmet Grilled Cheese & Tomato Soup", desc:"Elevated comfort food. Use fancy cheese, good bread, and homemade soup.", meta:"Quick & Easy \u00B7 25 min" },
    { icon:"\uD83C\uDF57", cat:"fancy", title:"Lemon Herb Roast Chicken", desc:"A whole roasted chicken with herbs, lemon, and roasted root vegetables. Feels fancy, tastes incredible.", meta:"Fancy Night In \u00B7 1.5 hrs" },
    { icon:"\uD83C\uDF5C", cat:"quick", title:"Stir Fry Night", desc:"Whatever veggies you have, some protein, soy sauce, and rice. Done in 20 minutes.", meta:"Quick & Easy \u00B7 20 min" },
    { icon:"\uD83C\uDF2F", cat:"fun", title:"Build-Your-Own Burrito Bowls", desc:"Rice, beans, protein, salsa, guac, cheese\u2014let everyone customize their bowl.", meta:"Fun & Easy \u00B7 30 min" },
    { icon:"\uD83E\uDD58", cat:"healthy", title:"Salmon & Quinoa Bowl", desc:"Pan-seared salmon over quinoa with avocado, edamame, and a sesame drizzle.", meta:"Healthy \u00B7 35 min" },
    { icon:"\uD83C\uDF54", cat:"comfort", title:"Smash Burgers", desc:"Crispy-edged, juicy smash burgers with all the toppings. Better than any restaurant.", meta:"Comfort Food \u00B7 30 min" },
    { icon:"\uD83E\uDDC7", cat:"takeout", title:"Thai Takeout", desc:"Pad thai, green curry, spring rolls\u2014let someone else do the hard work tonight.", meta:"Takeout \u00B7 0 effort" },
    { icon:"\uD83E\uDD5E", cat:"fun", title:"Breakfast for Dinner", desc:"Pancakes, eggs, bacon, the works. Because why not? Rules are made to be broken.", meta:"Fun & Easy \u00B7 25 min" },
    { icon:"\uD83C\uDF5A", cat:"quick", title:"Fried Rice", desc:"Use leftover rice, toss in whatever\u2019s in the fridge, add soy sauce and an egg. Chef\u2019s kiss.", meta:"Quick & Easy \u00B7 15 min" },
    { icon:"\uD83E\uDD6B", cat:"healthy", title:"Sheet Pan Chicken & Veggies", desc:"Everything on one pan. Chicken thighs, broccoli, sweet potatoes. Minimal dishes, maximum flavor.", meta:"Healthy \u00B7 40 min" },
    { icon:"\uD83E\uDDC0", cat:"fancy", title:"Charcuterie & Wine Night", desc:"Skip the cooking entirely. Fancy cheeses, meats, crackers, fruit, and a great bottle of wine.", meta:"Fancy Night In \u00B7 15 min prep" },
    { icon:"\uD83C\uDF5D", cat:"comfort", title:"Baked Ziti", desc:"Layers of pasta, ricotta, mozzarella, and marinara. Baked until golden and bubbly.", meta:"Comfort Food \u00B7 1 hr" },
    { icon:"\uD83C\uDF64", cat:"quick", title:"Quesadillas", desc:"Tortilla, cheese, whatever leftovers you have. Crisp it up. Dip in salsa. Perfect.", meta:"Quick & Easy \u00B7 10 min" },
    { icon:"\uD83E\uDD62", cat:"takeout", title:"Chinese Takeout", desc:"General Tso\u2019s, lo mein, egg rolls\u2014the classics. Fortune cookies for dessert.", meta:"Takeout \u00B7 0 effort" },
    { icon:"\uD83E\uDD59", cat:"healthy", title:"Mediterranean Wraps", desc:"Hummus, grilled chicken, veggies, and feta in a warm wrap. Fresh and filling.", meta:"Healthy \u00B7 20 min" },
    { icon:"\uD83C\uDF56", cat:"fancy", title:"Lamb Chops & Risotto", desc:"Date-night-at-home vibes. Seared lamb chops with creamy parmesan risotto.", meta:"Fancy Night In \u00B7 1 hr" },
    { icon:"\uD83E\uDD6E", cat:"fun", title:"Fondue Night", desc:"Cheese fondue for dinner, chocolate fondue for dessert. Dip everything. Share everything.", meta:"Fun & Easy \u00B7 30 min" },
    { icon:"\uD83C\uDF36\uFE0F", cat:"comfort", title:"Chili Night", desc:"A big pot of hearty chili with cornbread on the side. Perfect for a cozy evening.", meta:"Comfort Food \u00B7 1 hr" }
  ];
  let lastDinnerIdx = -1;

  function spinDinner() {
    let idx;
    do { idx = Math.floor(Math.random() * dinnerIdeas.length); } while (idx === lastDinnerIdx);
    lastDinnerIdx = idx;
    const d = dinnerIdeas[idx];
    const inner = document.getElementById("dinnerInner");
    inner.classList.add("switching");
    setTimeout(() => {
      document.getElementById("dinnerIcon").textContent = d.icon;
      const catEl = document.getElementById("dinnerCat");
      catEl.className = "gen-category " + d.cat;
      const catNames = { quick:"Quick & Easy", fancy:"Fancy", comfort:"Comfort Food", healthy:"Healthy", takeout:"Takeout", fun:"Fun" };
      catEl.textContent = catNames[d.cat] || d.cat;
      document.getElementById("dinnerTitle").textContent = d.title;
      document.getElementById("dinnerDesc").textContent = d.desc;
      document.getElementById("dinnerMeta").textContent = d.meta;
      inner.classList.remove("switching");
    }, 350);
  }

  // ── Photo Booth ──
  let boothStream = null;
  let boothFrame = 0;
  const boothFrames = [
    { border:"4px solid rgba(233,30,99,.6)", shadow:"inset 0 0 60px rgba(233,30,99,.15)", watermark:"\u2764\uFE0F Property of Brad \u2764\uFE0F", corners:"\u2764\uFE0F" },
    { border:"4px solid rgba(244,143,177,.6)", shadow:"inset 0 0 60px rgba(244,143,177,.15)", watermark:"\uD83D\uDC98 Brad & Katy Forever \uD83D\uDC98", corners:"\uD83D\uDC95" },
    { border:"4px solid rgba(255,215,0,.5)", shadow:"inset 0 0 60px rgba(255,215,0,.1)", watermark:"\u2728 My Beautiful Katy \u2728", corners:"\u2728" },
    { border:"4px solid rgba(255,69,0,.5)", shadow:"inset 0 0 60px rgba(255,69,0,.1)", watermark:"\uD83D\uDD25 Too Hot to Handle \uD83D\uDD25", corners:"\uD83D\uDD25" }
  ];

  function setBoothFrame(idx) {
    boothFrame = idx;
    document.querySelectorAll(".booth-frame-opt").forEach((el,i) => el.classList.toggle("active", i===idx));
    updateFrameOverlay();
  }

  function updateFrameOverlay() {
    const f = boothFrames[boothFrame];
    const ov = document.getElementById("boothFrameOverlay");
    ov.style.border = f.border;
    ov.style.boxShadow = f.shadow;
  }
  updateFrameOverlay();

  async function startBoothCamera() {
    const video = document.getElementById("boothCamera");
    if (boothStream) return;
    try {
      boothStream = await navigator.mediaDevices.getUserMedia({ video:{ facingMode:"user", width:{ideal:720}, height:{ideal:960} }, audio:false });
      video.srcObject = boothStream;
    } catch(e) {}
  }

  function stopBoothCamera() {
    if (boothStream) {
      boothStream.getTracks().forEach(t => t.stop());
      boothStream = null;
      document.getElementById("boothCamera").srcObject = null;
    }
  }

  function takeBoothPhoto() {
    const video = document.getElementById("boothCamera");
    const canvas = document.getElementById("boothCanvas");
    const vf = document.getElementById("boothViewfinder");
    if (!boothStream) return;
    canvas.width = video.videoWidth || 720;
    canvas.height = video.videoHeight || 960;
    const ctx = canvas.getContext("2d");
    // Mirror the image (front camera)
    ctx.translate(canvas.width, 0);
    ctx.scale(-1, 1);
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    ctx.setTransform(1,0,0,1,0,0);
    // Draw frame border
    const f = boothFrames[boothFrame];
    ctx.strokeStyle = f.border.match(/rgba?\([^)]+\)/)[0];
    ctx.lineWidth = 8;
    ctx.strokeRect(4,4,canvas.width-8,canvas.height-8);
    // Corners
    ctx.font = Math.round(canvas.width*0.06)+"px serif";
    ctx.fillText(f.corners, 16, Math.round(canvas.width*0.07)+10);
    ctx.fillText(f.corners, canvas.width-Math.round(canvas.width*0.07)-10, Math.round(canvas.width*0.07)+10);
    ctx.fillText(f.corners, 16, canvas.height-16);
    ctx.fillText(f.corners, canvas.width-Math.round(canvas.width*0.07)-10, canvas.height-16);
    // Watermark
    ctx.font = "bold "+Math.round(canvas.width*0.04)+"px -apple-system, sans-serif";
    ctx.fillStyle = "rgba(255,255,255,0.7)";
    ctx.textAlign = "center";
    ctx.fillText(f.watermark, canvas.width/2, canvas.height - Math.round(canvas.height*0.04));
    ctx.textAlign = "start";
    vf.classList.add("captured");
    document.getElementById("boothControls").style.display = "none";
    document.getElementById("boothActions").style.display = "flex";
  }

  function saveBoothPhoto() {
    const canvas = document.getElementById("boothCanvas");
    const link = document.createElement("a");
    link.download = "valentine-booth-"+Date.now()+".png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  }

  function retakeBoothPhoto() {
    document.getElementById("boothViewfinder").classList.remove("captured");
    document.getElementById("boothControls").style.display = "flex";
    document.getElementById("boothActions").style.display = "none";
  }

  // ── Weekly Challenge ──
  const challenges = [
    { icon:"\uD83C\uDF74", title:"Try a New Restaurant", desc:"Pick somewhere neither of you has been. Bonus points if it\u2019s a cuisine you\u2019ve never tried." },
    { icon:"\uD83D\uDC83", title:"Dance in the Kitchen", desc:"Put on your favorite song and dance together while cooking (or just because)." },
    { icon:"\uD83D\uDC8C", title:"Leave Love Notes", desc:"Hide little love notes around the house for each other to find throughout the week." },
    { icon:"\uD83C\uDF73", title:"Cook a Meal Together", desc:"Pick a recipe neither of you has tried. Work as a team. No takeout backup allowed!" },
    { icon:"\uD83C\uDFAC", title:"Movie Marathon Night", desc:"Pick a series or theme (80s classics, rom-coms, horror). Popcorn and blankets required." },
    { icon:"\uD83C\uDF05", title:"Go for a Sunset Walk", desc:"No phones allowed. Just walk, talk, and watch the sky change colors together." },
    { icon:"\uD83D\uDCDA", title:"Share a Childhood Memory", desc:"Tell each other a story from your childhood the other hasn\u2019t heard before." },
    { icon:"\uD83C\uDF81", title:"Plan a Surprise Date", desc:"Each of you secretly plans a date for the other. Execute them on different nights." },
    { icon:"\uD83D\uDC86", title:"Give Each Other Massages", desc:"Set the mood with candles and music. Take turns giving 15-minute massages." },
    { icon:"\uD83D\uDCF5", title:"No Phones Evening", desc:"Put phones away for an entire evening. Board games, conversation, or whatever happens!" },
    { icon:"\u2615", title:"Morning Coffee Together", desc:"Wake up 15 minutes early every day this week to have coffee together before the chaos." },
    { icon:"\uD83D\uDDBC\uFE0F", title:"Recreate an Old Photo", desc:"Find a favorite photo from early in your relationship and recreate it today." },
    { icon:"\uD83C\uDFB5", title:"Make a Playlist Together", desc:"Each pick 10 songs that remind you of each other. Combine into one playlist." },
    { icon:"\uD83C\uDF1F", title:"Compliment Challenge", desc:"Give each other at least 3 genuine, specific compliments every day this week." },
    { icon:"\uD83D\uDE97", title:"Take a Spontaneous Drive", desc:"Get in the car with no destination. Stop wherever looks interesting." },
    { icon:"\uD83C\uDFAE", title:"Learn Something Together", desc:"Pick a new skill (cooking technique, card game, dance move) and learn it as a team." },
    { icon:"\uD83D\uDCDD", title:"Write Each Other Letters", desc:"Write a handwritten letter to each other. Exchange them over dinner." },
    { icon:"\uD83E\uDDD8", title:"Morning Stretch Together", desc:"Start each morning this week with 10 minutes of stretching or yoga together." },
    { icon:"\uD83C\uDF4B", title:"Make Cocktails at Home", desc:"Pick two cocktail recipes. Each person makes one. Rate and enjoy!" },
    { icon:"\uD83D\uDCF8", title:"Photo Challenge", desc:"Take one photo together every day this week. Different location or pose each time." },
    { icon:"\u2B50", title:"Bucket List Night", desc:"Sit down together and write a couples bucket list of 20 things you want to do." },
    { icon:"\uD83E\uDD17", title:"20-Second Hug", desc:"Give each other a real, 20-second hug at least once every day this week. No rushing." },
    { icon:"\uD83C\uDFB2", title:"Truth or Dare (Couples Edition)", desc:"Take turns asking truth or dare\u2014but keep it romantic, spicy, or sweet." },
    { icon:"\uD83C\uDF0C", title:"Stargaze Together", desc:"Find a clear night, lay out a blanket, and look up at the stars. Talk about everything." }
  ];

  const CHALLENGE_KEY = "valentine-challenge";
  let currentChallenge = null;
  let challengeCompleted = false;

  function loadChallengeState() {
    try {
      const saved = JSON.parse(localStorage.getItem(CHALLENGE_KEY) || "{}");
      currentChallenge = saved.current != null ? saved.current : null;
      challengeCompleted = saved.done || false;
      return saved.completedCount || 0;
    } catch(e) { return 0; }
  }

  function saveChallengeState(completedCount) {
    localStorage.setItem(CHALLENGE_KEY, JSON.stringify({
      current: currentChallenge,
      done: challengeCompleted,
      completedCount: completedCount
    }));
  }

  function getChallengeCompletedCount() {
    try { return JSON.parse(localStorage.getItem(CHALLENGE_KEY) || "{}").completedCount || 0; } catch(e) { return 0; }
  }

  function updateChallengeUI() {
    const count = getChallengeCompletedCount();
    document.getElementById("challengeCount").innerHTML = count + " challenge" + (count!==1?"s":"") + " completed \u2764\uFE0F";
    document.getElementById("challengeBarFill").style.width = Math.min(count/challenges.length*100, 100) + "%";
    const check = document.getElementById("challengeCheck");
    check.classList.toggle("done", challengeCompleted);
    if (currentChallenge != null) {
      const c = challenges[currentChallenge];
      document.getElementById("challengeIcon").textContent = c.icon;
      document.getElementById("challengeTitle").textContent = c.title;
      document.getElementById("challengeDesc").textContent = c.desc;
    }
  }

  function newChallenge() {
    let idx;
    do { idx = Math.floor(Math.random() * challenges.length); } while (idx === currentChallenge);
    currentChallenge = idx;
    challengeCompleted = false;
    const inner = document.getElementById("challengeInner");
    inner.classList.add("switching");
    setTimeout(() => {
      updateChallengeUI();
      inner.classList.remove("switching");
    }, 350);
    saveChallengeState(getChallengeCompletedCount());
  }

  function toggleChallengeComplete() {
    if (currentChallenge == null) return;
    challengeCompleted = !challengeCompleted;
    let count = getChallengeCompletedCount();
    if (challengeCompleted) count++; else count = Math.max(0, count - 1);
    saveChallengeState(count);
    updateChallengeUI();
  }

  loadChallengeState();
  updateChallengeUI();

  // ── Word Jumble Game ──
  const jumbleWords = [
    "LOVE","KISS","HEART","ROMANCE","PASSION","FOREVER","HUSBAND","WIFE",
    "SOULMATE","DEVOTION","CHERISH","ADORE","SWEETHEART","DARLING",
    "EMBRACE","TENDERNESS","AFFECTION","VALENTINE","BELOVED","TREASURE",
    "COMMITMENT","TOGETHER","BEAUTIFUL","GORGEOUS","AMAZING","INCREDIBLE",
    "STUNNING","LOVELY","PERFECT","ANGEL","DESIRE","BLISS","WARMTH",
    "INTIMATE","HAPPINESS","DESTINY","ETERNITY","MAGNETIC","INFATUATE"
  ];
  let jumbleAnswer = "";
  let jumbleScore = 0;
  let jumbleRevealed = false;
  let jumbleLastIdx = -1;

  function scrambleWord(word) {
    const arr = word.split("");
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    const result = arr.join("");
    // Make sure it's actually different from the original
    if (result === word && word.length > 1) return scrambleWord(word);
    return result;
  }

  function nextJumble() {
    let idx;
    do { idx = Math.floor(Math.random() * jumbleWords.length); } while (idx === jumbleLastIdx);
    jumbleLastIdx = idx;
    jumbleAnswer = jumbleWords[idx];
    jumbleRevealed = false;
    const scrambled = scrambleWord(jumbleAnswer);
    document.getElementById("jumbleScrambled").textContent = scrambled;
    document.getElementById("jumbleScrambled").classList.remove("shake");
    document.getElementById("jumbleHint").textContent = jumbleAnswer.length + " letters \u2022 a word about love";
    document.getElementById("jumbleInput").value = "";
    document.getElementById("jumbleFeedback").textContent = "";
    document.getElementById("jumbleFeedback").className = "jumble-feedback";
    document.getElementById("jumbleInput").focus();
  }

  function checkJumble() {
    if (!jumbleAnswer || jumbleRevealed) return;
    const guess = document.getElementById("jumbleInput").value.trim().toUpperCase();
    const fb = document.getElementById("jumbleFeedback");
    if (!guess) { fb.textContent = "Type a guess first!"; fb.className = "jumble-feedback wrong"; return; }
    if (guess === jumbleAnswer) {
      jumbleScore++;
      jumbleRevealed = true;
      document.getElementById("jumbleScore").innerHTML = "\u2764\uFE0F Score: " + jumbleScore;
      const msgs = ["You got it! \uD83C\uDF89","Amazing! \u2764\uFE0F","So smart! \uD83D\uDC96","Nailed it! \u2728","Perfect! \uD83D\uDC95","Brilliant! \uD83C\uDF1F"];
      fb.textContent = msgs[Math.floor(Math.random()*msgs.length)];
      fb.className = "jumble-feedback correct";
      // Celebration burst
      const card = document.getElementById("jumbleCard");
      const emojis = ["\u2764\uFE0F","\uD83D\uDC95","\uD83D\uDC96","\u2728","\uD83C\uDF89","\uD83C\uDF1F","\uD83D\uDC97"];
      for (let i = 0; i < 10; i++) {
        const s = document.createElement("span");
        s.className = "jumble-celebrate";
        s.textContent = emojis[Math.floor(Math.random()*emojis.length)];
        s.style.left = (35 + Math.random()*30) + "%";
        s.style.top = (20 + Math.random()*30) + "%";
        s.style.setProperty("--cx", (Math.random()*200-100)+"px");
        s.style.setProperty("--cy", (Math.random()*-150-30)+"px");
        s.style.setProperty("--cr", (Math.random()*360-180)+"deg");
        card.appendChild(s);
        setTimeout(() => s.remove(), 1100);
      }
    } else {
      document.getElementById("jumbleScrambled").classList.remove("shake");
      void document.getElementById("jumbleScrambled").offsetWidth;
      document.getElementById("jumbleScrambled").classList.add("shake");
      const near = [..."So close, try again! \uD83D\uDCAA","Not quite\u2014keep going! \u2764\uFE0F","Almost! Give it another shot \u2728"];
      fb.textContent = near[Math.floor(Math.random()*near.length)];
      fb.className = "jumble-feedback wrong";
    }
  }

  function revealJumble() {
    if (!jumbleAnswer || jumbleRevealed) return;
    jumbleRevealed = true;
    const fb = document.getElementById("jumbleFeedback");
    fb.textContent = "The answer was: " + jumbleAnswer + " \uD83D\uDC94";
    fb.className = "jumble-feedback reveal";
  }

  // Allow Enter key to check answer
  document.getElementById("jumbleInput").addEventListener("keydown", (e) => {
    if (e.key === "Enter") checkJumble();
  });

  // ── Game Switcher ──
  const gameNames = ["jumble","wordsearch","hptrivia"];
  function switchGame(game) {
    document.querySelectorAll(".game-section").forEach(s => s.classList.remove("active"));
    document.querySelectorAll(".game-switcher-btn").forEach(b => b.classList.remove("active"));
    document.getElementById("game-" + game).classList.add("active");
    const btns = document.querySelectorAll(".game-switcher-btn");
    const idx = gameNames.indexOf(game);
    if (idx >= 0 && btns[idx]) btns[idx].classList.add("active");
    if (game === "wordsearch" && !wsInitialized) { newWordSearch(); wsInitialized = true; }
    if (game === "hptrivia" && !hpInitialized) { nextHP(); hpInitialized = true; }
  }

  // ── Word Search Game ──
  const wsAllWords = [
    "LOVE","KISS","HEART","ROMANCE","PASSION","FOREVER","HUSBAND","WIFE",
    "SOULMATE","DEVOTION","CHERISH","ADORE","SWEETHEART","DARLING",
    "BRAD","KATY","VALENTINE","BELOVED","TOGETHER","BEAUTIFUL","AMAZING","ANGEL"
  ];
  let wsInitialized = false;
  let wsGrid = [];
  let wsSize = 12;
  let wsWords = [];
  let wsPlacedWords = [];
  let wsFoundWords = [];
  let wsFoundCount = 0;
  let wsSelecting = false;
  let wsStartCell = null;
  let wsCurrCell = null;
  let wsSelectedCells = [];
  let wsTimerInterval = null;
  let wsSeconds = 0;
  let wsComplete = false;

  const wsColors = ["found-0","found-1","found-2","found-3","found-4","found-5","found-6","found-7"];
  const wsDirs = [
    [0,1],[1,0],[0,-1],[-1,0],  // right, down, left, up
    [1,1],[1,-1],[-1,1],[-1,-1] // diagonals
  ];

  function wsGetSize() {
    return window.innerWidth <= 480 ? 10 : 12;
  }

  function wsShuffle(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  function wsCanPlace(word, r, c, dr, dc, grid, size) {
    for (let k = 0; k < word.length; k++) {
      const nr = r + dr * k, nc = c + dc * k;
      if (nr < 0 || nr >= size || nc < 0 || nc >= size) return false;
      if (grid[nr][nc] !== "" && grid[nr][nc] !== word[k]) return false;
    }
    return true;
  }

  function wsPlaceWord(word, grid, size) {
    const shuffledDirs = wsShuffle(wsDirs);
    const attempts = 100;
    for (let a = 0; a < attempts; a++) {
      const dir = shuffledDirs[a % shuffledDirs.length];
      const r = Math.floor(Math.random() * size);
      const c = Math.floor(Math.random() * size);
      if (wsCanPlace(word, r, c, dir[0], dir[1], grid, size)) {
        const cells = [];
        for (let k = 0; k < word.length; k++) {
          grid[r + dir[0]*k][c + dir[1]*k] = word[k];
          cells.push([r + dir[0]*k, c + dir[1]*k]);
        }
        return cells;
      }
    }
    return null;
  }

  function wsGenerateGrid() {
    wsSize = wsGetSize();
    wsGrid = Array.from({length: wsSize}, () => Array(wsSize).fill(""));
    const shuffled = wsShuffle(wsAllWords);
    wsPlacedWords = [];
    wsWords = [];
    // Try to place 8-10 words
    for (const word of shuffled) {
      if (wsWords.length >= 8 && word.length > wsSize) continue;
      if (wsWords.length >= 10) break;
      const cells = wsPlaceWord(word, wsGrid, wsSize);
      if (cells) {
        wsWords.push(word);
        wsPlacedWords.push({ word, cells });
      }
    }
    // Fill empty cells with random letters
    const alpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    for (let r = 0; r < wsSize; r++) {
      for (let c = 0; c < wsSize; c++) {
        if (wsGrid[r][c] === "") wsGrid[r][c] = alpha[Math.floor(Math.random() * 26)];
      }
    }
  }

  function wsRenderGrid() {
    const gridEl = document.getElementById("wsGrid");
    gridEl.className = "ws-grid size-" + wsSize;
    gridEl.innerHTML = "";
    for (let r = 0; r < wsSize; r++) {
      for (let c = 0; c < wsSize; c++) {
        const cell = document.createElement("div");
        cell.className = "ws-cell";
        cell.textContent = wsGrid[r][c];
        cell.dataset.r = r;
        cell.dataset.c = c;
        gridEl.appendChild(cell);
      }
    }
  }

  function wsRenderWordList() {
    const list = document.getElementById("wsWordList");
    list.innerHTML = "";
    wsWords.forEach(w => {
      const tag = document.createElement("span");
      tag.className = "ws-word-tag";
      tag.id = "ws-tag-" + w;
      tag.textContent = w;
      list.appendChild(tag);
    });
  }

  function wsCellAt(r, c) {
    return document.querySelector('.ws-cell[data-r="'+r+'"][data-c="'+c+'"]');
  }

  function wsGetCellFromEvent(e) {
    const touch = e.touches ? e.touches[0] : e;
    const el = document.elementFromPoint(touch.clientX, touch.clientY);
    if (el && el.classList.contains("ws-cell")) return el;
    return null;
  }

  function wsCellsInLine(r1, c1, r2, c2) {
    const dr = Math.sign(r2 - r1), dc = Math.sign(c2 - c1);
    const dist = Math.max(Math.abs(r2 - r1), Math.abs(c2 - c1));
    // Must be a straight line (horizontal, vertical, or 45-degree diagonal)
    if (r1 !== r2 && c1 !== c2 && Math.abs(r2-r1) !== Math.abs(c2-c1)) return [];
    const cells = [];
    for (let k = 0; k <= dist; k++) {
      cells.push([r1 + dr*k, c1 + dc*k]);
    }
    return cells;
  }

  function wsClearSelection() {
    document.querySelectorAll(".ws-cell.selecting").forEach(c => c.classList.remove("selecting"));
    wsSelectedCells = [];
  }

  function wsHighlightSelection(cells) {
    wsClearSelection();
    cells.forEach(([r,c]) => {
      const cell = wsCellAt(r, c);
      if (cell) cell.classList.add("selecting");
    });
    wsSelectedCells = cells;
  }

  function wsCheckSelection() {
    if (wsSelectedCells.length === 0) return;
    const selectedWord = wsSelectedCells.map(([r,c]) => wsGrid[r][c]).join("");
    const reversedWord = [...selectedWord].reverse().join("");
    for (const placed of wsPlacedWords) {
      if (wsFoundWords.includes(placed.word)) continue;
      if (selectedWord === placed.word || reversedWord === placed.word) {
        wsFoundWords.push(placed.word);
        wsFoundCount++;
        const colorClass = wsColors[wsFoundCount % wsColors.length];
        wsSelectedCells.forEach(([r,c]) => {
          const cell = wsCellAt(r, c);
          if (cell) { cell.classList.remove("selecting"); cell.classList.add(colorClass); }
        });
        const tag = document.getElementById("ws-tag-" + placed.word);
        if (tag) tag.classList.add("found");
        document.getElementById("wsFound").innerHTML = "&#10084;&#65039; Found: " + wsFoundCount + " / " + wsWords.length;
        if (wsFoundCount === wsWords.length) wsCompleteGame();
        return;
      }
    }
  }

  function wsCompleteGame() {
    wsComplete = true;
    clearInterval(wsTimerInterval);
    document.getElementById("wsCompleteMsg").classList.add("show");
    // Celebration burst
    const card = document.getElementById("wsCard");
    const emojis = ["\u2764\uFE0F","\uD83D\uDC95","\uD83D\uDC96","\u2728","\uD83C\uDF89","\uD83C\uDF1F","\uD83D\uDC97"];
    for (let i = 0; i < 14; i++) {
      const s = document.createElement("span");
      s.className = "ws-celebrate";
      s.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      s.style.left = (20 + Math.random()*60) + "%";
      s.style.top = (10 + Math.random()*40) + "%";
      s.style.setProperty("--cx", (Math.random()*200-100)+"px");
      s.style.setProperty("--cy", (Math.random()*-150-30)+"px");
      s.style.setProperty("--cr", (Math.random()*360-180)+"deg");
      card.appendChild(s);
      setTimeout(() => s.remove(), 1100);
    }
  }

  function wsStartTimer() {
    clearInterval(wsTimerInterval);
    wsSeconds = 0;
    wsTimerInterval = setInterval(() => {
      wsSeconds++;
      const m = Math.floor(wsSeconds / 60);
      const s = wsSeconds % 60;
      document.getElementById("wsTimer").innerHTML = "&#9201; " + m + ":" + (s < 10 ? "0" : "") + s;
    }, 1000);
  }

  function newWordSearch() {
    wsFoundWords = [];
    wsFoundCount = 0;
    wsComplete = false;
    document.getElementById("wsCompleteMsg").classList.remove("show");
    wsGenerateGrid();
    wsRenderGrid();
    wsRenderWordList();
    document.getElementById("wsFound").innerHTML = "&#10084;&#65039; Found: 0 / " + wsWords.length;
    wsStartTimer();
    wsBindEvents();
  }

  function wsBindEvents() {
    const wrap = document.getElementById("wsGridWrap");
    // Remove old listeners by replacing node
    const newWrap = wrap.cloneNode(true);
    wrap.parentNode.replaceChild(newWrap, wrap);
    const gridEl = newWrap.querySelector("#wsGrid");

    function onStart(e) {
      if (wsComplete) return;
      e.preventDefault();
      const cell = wsGetCellFromEvent(e);
      if (!cell) return;
      wsSelecting = true;
      wsStartCell = cell;
      wsCurrCell = cell;
      wsHighlightSelection([[+cell.dataset.r, +cell.dataset.c]]);
    }
    function onMove(e) {
      if (!wsSelecting || wsComplete) return;
      e.preventDefault();
      const cell = wsGetCellFromEvent(e);
      if (!cell || cell === wsCurrCell) return;
      wsCurrCell = cell;
      const r1 = +wsStartCell.dataset.r, c1 = +wsStartCell.dataset.c;
      const r2 = +cell.dataset.r, c2 = +cell.dataset.c;
      const cells = wsCellsInLine(r1, c1, r2, c2);
      if (cells.length > 0) wsHighlightSelection(cells);
    }
    function onEnd(e) {
      if (!wsSelecting) return;
      wsSelecting = false;
      wsCheckSelection();
      wsClearSelection();
    }

    newWrap.addEventListener("mousedown", onStart);
    newWrap.addEventListener("mousemove", onMove);
    newWrap.addEventListener("mouseup", onEnd);
    newWrap.addEventListener("mouseleave", onEnd);
    newWrap.addEventListener("touchstart", onStart, {passive: false});
    newWrap.addEventListener("touchmove", onMove, {passive: false});
    newWrap.addEventListener("touchend", onEnd);
  }

  // ── Harry Potter Trivia ──
  let hpInitialized = false;
  let hpScore = 0;
  let hpTotal = 0;
  let hpSelected = -1;
  let hpAnswered = false;
  let hpStreak = 0;
  let hpUsed = [];
  let hpCurrent = null;

  const hpQuestions = [
    // ─── EASY ───
    {q:"What Hogwarts house is Harry Potter sorted into?", a:["Gryffindor","Slytherin","Ravenclaw","Hufflepuff"], c:0, d:"easy",
     ex:"The Sorting Hat placed Harry in Gryffindor, the house of the brave!"},
    {q:"What is Hermione's cat's name?", a:["Crookshanks","Mrs. Norris","Scabbers","Hedwig"], c:0, d:"easy",
     ex:"Crookshanks is Hermione's half-Kneazle ginger cat."},
    {q:"What position does Harry play in Quidditch?", a:["Seeker","Chaser","Beater","Keeper"], c:0, d:"easy",
     ex:"Harry is the youngest Seeker in a century!"},
    {q:"What is the name of Harry's pet owl?", a:["Hedwig","Errol","Pigwidgeon","Fawkes"], c:0, d:"easy",
     ex:"Hedwig was a beautiful snowy owl given to Harry by Hagrid."},
    {q:"Who is the headmaster of Hogwarts when Harry first arrives?", a:["Albus Dumbledore","Severus Snape","Minerva McGonagall","Dolores Umbridge"], c:0, d:"easy",
     ex:"Dumbledore is considered one of the greatest wizards of all time."},
    {q:"What platform at King's Cross do students use to get to Hogwarts?", a:["Platform 9\u00BE","Platform 7\u00BD","Platform 10","Platform 8"], c:0, d:"easy",
     ex:"You have to run through the barrier between platforms 9 and 10!"},
    {q:"What is the name of the magical map that shows everyone in Hogwarts?", a:["The Marauder's Map","The Hogwarts Atlas","The Wizard's Guide","The Enchanted Chart"], c:0, d:"easy",
     ex:"'I solemnly swear that I am up to no good!' activates the map."},
    {q:"What creature guards the entrance to Dumbledore's office?", a:["A gargoyle","A sphinx","A dragon","A troll"], c:0, d:"easy",
     ex:"You need a password (usually a candy name) to get the gargoyle to move!"},
    {q:"Who is Harry's best friend besides Hermione?", a:["Ron Weasley","Neville Longbottom","Draco Malfoy","Dean Thomas"], c:0, d:"easy",
     ex:"Ron and Harry became best friends on the Hogwarts Express!"},
    {q:"What sport do witches and wizards play on broomsticks?", a:["Quidditch","Broomball","Wizardball","Skyball"], c:0, d:"easy",
     ex:"Quidditch has four balls: Quaffle, two Bludgers, and the Golden Snitch."},
    {q:"What animal can Sirius Black transform into?", a:["A large black dog","A stag","A rat","A wolf"], c:0, d:"easy",
     ex:"Sirius is an unregistered Animagus who takes the form of a big black dog!"},

    // ─── MEDIUM ───
    {q:"What are the three Deathly Hallows?", a:["Elder Wand, Resurrection Stone, Invisibility Cloak","Elder Wand, Philosopher's Stone, Invisibility Cloak","Elder Wand, Resurrection Stone, Time-Turner","Sword of Gryffindor, Resurrection Stone, Invisibility Cloak"], c:0, d:"medium",
     ex:"Together they make the owner the Master of Death."},
    {q:"Who is the Half-Blood Prince?", a:["Severus Snape","Tom Riddle","Albus Dumbledore","Draco Malfoy"], c:0, d:"medium",
     ex:"Snape's mother was a witch named Eileen Prince; his father was a Muggle."},
    {q:"What form does Harry's Patronus take?", a:["A stag","A doe","A phoenix","An otter"], c:0, d:"medium",
     ex:"Harry's Patronus is a stag, the same Animagus form as his father James."},
    {q:"What is the core of Harry's wand?", a:["Phoenix feather","Dragon heartstring","Unicorn hair","Thestral tail hair"], c:0, d:"medium",
     ex:"The feather came from Fawkes, who also gave the feather in Voldemort's wand!"},
    {q:"What does the spell 'Expecto Patronum' do?", a:["Conjures a Patronus to repel Dementors","Disarms an opponent","Creates a shield charm","Produces light from the wand"], c:0, d:"medium",
     ex:"A Patronus is a projection of positive energy that drives away Dementors."},
    {q:"How many Horcruxes did Voldemort create intentionally?", a:["Six","Seven","Five","Eight"], c:0, d:"medium",
     ex:"He made six on purpose; Harry became an unintentional seventh."},
    {q:"What does Amortentia (the most powerful love potion) smell like?", a:["Different for everyone, based on what attracts them","Roses and chocolate","Firewhiskey","Treacle tart and broomstick polish"], c:0, d:"medium",
     ex:"Hermione smelled fresh-cut grass, new parchment, and Ron's hair."},
    {q:"What is the name of the Weasley family's home?", a:["The Burrow","The Den","Shell Cottage","Grimmauld Place"], c:0, d:"medium",
     ex:"The Burrow is a wonderfully cozy, magically constructed home near Ottery St Catchpole."},
    {q:"Which spell is known as the Killing Curse?", a:["Avada Kedavra","Crucio","Imperio","Sectumsempra"], c:0, d:"medium",
     ex:"It's one of the three Unforgivable Curses, and leaves no trace on the body."},
    {q:"What magical creature can only be seen by those who have witnessed death?", a:["Thestrals","Dementors","Boggarts","Hippogriffs"], c:0, d:"medium",
     ex:"Harry first sees the Thestrals pulling the Hogwarts carriages in his fifth year."},
    {q:"What is Voldemort's real name?", a:["Tom Marvolo Riddle","Tom Salazar Riddle","Thomas Riddle","Marvolo Gaunt"], c:0, d:"medium",
     ex:"He rearranged 'Tom Marvolo Riddle' to make 'I am Lord Voldemort.'"},

    // ─── HARD ───
    {q:"Who are the four founders of Hogwarts?", a:["Godric Gryffindor, Helga Hufflepuff, Rowena Ravenclaw, Salazar Slytherin","Godric Gryffindor, Helena Hufflepuff, Rowena Ravenclaw, Salazar Slytherin","Godric Gryffindor, Helga Hufflepuff, Rowena Ravenclaw, Severus Slytherin","Garrick Gryffindor, Helga Hufflepuff, Rowena Ravenclaw, Salazar Slytherin"], c:0, d:"hard",
     ex:"The four founders built Hogwarts together over a thousand years ago!"},
    {q:"What potion did Slughorn show on the first day of his Potions class in Harry's 6th year?", a:["Amortentia, Polyjuice Potion, Felix Felicis, and Veritaserum","Amortentia, Wolfsbane, Felix Felicis, and Veritaserum","Amortentia, Polyjuice Potion, Draught of Living Death, and Veritaserum","Amortentia, Polyjuice Potion, Felix Felicis, and Skele-Gro"], c:0, d:"hard",
     ex:"Felix Felicis (liquid luck) was offered as a prize for the best Draught of Living Death."},
    {q:"What is the incantation to summon the Dark Mark?", a:["Morsmordre","Serpensortia","Sectumsempra","Deletrius"], c:0, d:"hard",
     ex:"Death Eaters cast Morsmordre to conjure the skull-and-serpent Dark Mark in the sky."},
    {q:"What is the name of the centaur who teaches Divination after Trelawney is sacked?", a:["Firenze","Bane","Ronan","Magorian"], c:0, d:"hard",
     ex:"Firenze was banished from his herd for agreeing to work for Dumbledore."},
    {q:"What are the names of Draco Malfoy's two cronies?", a:["Vincent Crabbe and Gregory Goyle","Vincent Goyle and Gregory Crabbe","Marcus Crabbe and Blaise Goyle","Theodore Crabbe and Gregory Goyle"], c:0, d:"hard",
     ex:"Crabbe and Goyle are Draco's dim-witted but loyal sidekicks throughout the series."},
    {q:"Which spell does Hermione use to erase her parents' memories?", a:["Obliviate","Confundo","Stupefy","Legilimens"], c:0, d:"hard",
     ex:"Hermione modified her parents' memories so they'd move to Australia and forget her."},
    {q:"What does the Mirror of Erised show?", a:["The deepest desire of one's heart","The future","The past","One's worst fear"], c:0, d:"hard",
     ex:"'Erised' is 'Desire' backwards. Harry sees his parents; Ron sees himself as Head Boy."},
    {q:"What is the address of the Order of the Phoenix headquarters?", a:["12 Grimmauld Place","4 Privet Drive","13 Diagon Alley","7 Godric's Hollow"], c:0, d:"hard",
     ex:"The house belonged to the Black family and was inherited by Sirius."},
    {q:"What is Nearly Headless Nick's full name?", a:["Sir Nicholas de Mimsy-Porpington","Sir Nicholas de Mimsy-Paddington","Sir Nicholas de Canterbury","Sir Nicholas Flamel"], c:0, d:"hard",
     ex:"He was hit 45 times with a blunt axe but his head didn't come fully off!"},
    {q:"What type of dragon does Harry face in the Triwizard Tournament?", a:["Hungarian Horntail","Norwegian Ridgeback","Swedish Short-Snout","Chinese Fireball"], c:0, d:"hard",
     ex:"The Hungarian Horntail is considered the most dangerous dragon breed."},
    {q:"What is the name of the house-elf who served the Crouch family?", a:["Winky","Dobby","Kreacher","Hokey"], c:0, d:"hard",
     ex:"Winky was freed by Bartemius Crouch Sr. and ended up working at Hogwarts."},
    {q:"What plant does Neville use to breathe underwater in the film version of the second task?", a:["Gillyweed","Mandrake","Venomous Tentacula","Bubotuber"], c:0, d:"hard",
     ex:"In the book, Dobby gives Harry the Gillyweed. In the film, Neville suggests it!"},
    {q:"What does the spell 'Episkey' do?", a:["Heals minor injuries","Opens locked doors","Makes objects fly","Creates fire"], c:0, d:"hard",
     ex:"Tonks uses Episkey to fix Harry's broken nose on the Hogwarts Express."},
    {q:"What is the name of the Wizarding prison guarded by Dementors?", a:["Azkaban","Nurmengard","The Ministry Dungeon","Durmstrang"], c:0, d:"hard",
     ex:"Azkaban is located on an island in the middle of the North Sea."}
  ];

  const hpCorrectMsgs = [
    "\u26A1 Wingardium Leviosa! You got it!",
    "\u26A1 10 points to Gryffindor!",
    "\u2728 Brilliant! Hermione would be proud!",
    "\uD83E\uDE84 Mischief managed! That's correct!",
    "\uD83E\uDD89 Hedwig approves! Well done!",
    "\uD83C\uDF1F Outstanding! You're a true witch or wizard!",
    "\u26A1 Expecto Patronum! Your knowledge shines!",
    "\uD83E\uDE84 Accio correct answer! You nailed it!"
  ];
  const hpWrongMsgs = [
    "\uD83D\uDC80 Not quite... even Neville would've known that!",
    "\uD83D\uDC0D The basilisk strikes! Wrong answer...",
    "\uD83E\uDDD9 Even Trelawney couldn't have predicted that answer...",
    "\u26A1 Obliviate! Let's forget that happened...",
    "\uD83E\uDE84 That spell backfired! Try again next time!"
  ];

  function hpShuffle(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  function nextHP() {
    hpSelected = -1;
    hpAnswered = false;
    document.getElementById("hpFeedback").textContent = "";
    document.getElementById("hpFeedback").className = "hp-feedback";
    document.getElementById("hpSubmit").style.display = "";
    document.getElementById("hpSubmit").disabled = true;
    document.getElementById("hpNext").style.display = "none";

    // Pick a question not recently used
    if (hpUsed.length >= hpQuestions.length - 2) hpUsed = [];
    let idx;
    do { idx = Math.floor(Math.random() * hpQuestions.length); } while (hpUsed.includes(idx));
    hpUsed.push(idx);
    hpCurrent = hpQuestions[idx];

    // Shuffle answers while tracking correct
    const correctText = hpCurrent.a[hpCurrent.c];
    const shuffledAnswers = hpShuffle(hpCurrent.a);
    const newCorrectIdx = shuffledAnswers.indexOf(correctText);

    document.getElementById("hpQNum").innerHTML = "\uD83E\uDE84 Question " + (hpTotal + 1) +
      ' <span class="hp-difficulty ' + hpCurrent.d + '">' + hpCurrent.d + '</span>';
    document.getElementById("hpQuestion").textContent = hpCurrent.q;

    const answersEl = document.getElementById("hpAnswers");
    answersEl.innerHTML = "";
    shuffledAnswers.forEach((ans, i) => {
      const btn = document.createElement("button");
      btn.className = "hp-answer";
      btn.textContent = ans;
      btn.dataset.idx = i;
      btn.dataset.correct = (i === newCorrectIdx) ? "1" : "0";
      btn.onclick = function() { selectHP(this); };
      answersEl.appendChild(btn);
    });
  }

  function selectHP(btn) {
    if (hpAnswered) return;
    document.querySelectorAll(".hp-answer").forEach(b => b.classList.remove("selected"));
    btn.classList.add("selected");
    hpSelected = +btn.dataset.idx;
    document.getElementById("hpSubmit").disabled = false;
  }

  function submitHP() {
    if (hpSelected < 0 || hpAnswered) return;
    hpAnswered = true;
    hpTotal++;
    const btns = document.querySelectorAll(".hp-answer");
    const selectedBtn = btns[hpSelected];
    const isCorrect = selectedBtn.dataset.correct === "1";

    btns.forEach(b => {
      b.classList.add("disabled");
      if (b.dataset.correct === "1") b.classList.add("correct");
      else if (b === selectedBtn && !isCorrect) b.classList.add("wrong");
    });

    const fb = document.getElementById("hpFeedback");
    if (isCorrect) {
      hpScore++;
      hpStreak++;
      fb.className = "hp-feedback correct";
      fb.textContent = hpCorrectMsgs[Math.floor(Math.random() * hpCorrectMsgs.length)];
      // Celebration on streak
      if (hpStreak >= 3) {
        const card = document.getElementById("hpCard");
        const emojis = ["\u26A1","\uD83E\uDE84","\uD83E\uDD89","\u2728","\uD83C\uDF1F","\uD83E\uDDD9","\uD83D\uDC09"];
        for (let i = 0; i < 10; i++) {
          const s = document.createElement("span");
          s.className = "hp-celebrate";
          s.textContent = emojis[Math.floor(Math.random()*emojis.length)];
          s.style.left = (25 + Math.random()*50) + "%";
          s.style.top = (15 + Math.random()*30) + "%";
          s.style.setProperty("--cx", (Math.random()*200-100)+"px");
          s.style.setProperty("--cy", (Math.random()*-150-30)+"px");
          s.style.setProperty("--cr", (Math.random()*360-180)+"deg");
          card.appendChild(s);
          setTimeout(() => s.remove(), 1100);
        }
      }
    } else {
      hpStreak = 0;
      fb.className = "hp-feedback wrong";
      fb.textContent = hpWrongMsgs[Math.floor(Math.random() * hpWrongMsgs.length)];
    }

    // Show explanation
    if (hpCurrent.ex) {
      fb.textContent += "\n" + hpCurrent.ex;
    }

    document.getElementById("hpScore").innerHTML = "\u26A1 Score: " + hpScore + " / " + hpTotal;
    document.getElementById("hpSubmit").style.display = "none";
    document.getElementById("hpNext").style.display = "";

    // Streak display
    const streakEl = document.getElementById("hpStreak");
    if (hpStreak >= 3) {
      streakEl.innerHTML = "\uD83D\uDD25 " + hpStreak + " in a row! You're on fire!";
    } else if (hpStreak >= 2) {
      streakEl.textContent = "\u2728 " + hpStreak + " in a row!";
    } else {
      streakEl.textContent = "";
    }
  }

  // ── My Purses Gallery ──
  const purseCount = 48;
  const purseCollection = [];
  for (let i = 1; i <= purseCount; i++) {
    purseCollection.push({ img: "/static/purses/purse" + i + ".jpg" });
  }

  let purseLBIndex = 0;

  function renderPurseGrid() {
    const grid = document.getElementById("purseGrid");
    grid.innerHTML = "";
    document.getElementById("purseCount").innerHTML =
      '<span class="purse-count-badge">\uD83D\uDC5C ' + purseCollection.length + ' Purses</span>';
    purseCollection.forEach((p, i) => {
      const card = document.createElement("div");
      card.className = "purse-card";
      card.onclick = () => openPurseLB(i);
      card.innerHTML = '<img class="purse-card-img" src="' + p.img + '" alt="Purse ' + (i+1) + '" loading="lazy">';
      grid.appendChild(card);
    });
  }

  function openPurseLB(idx) {
    purseLBIndex = idx;
    updatePurseLB();
    document.getElementById("purseLightbox").classList.add("open");
    document.body.style.overflow = "hidden";
  }

  function closePurseLB() {
    document.getElementById("purseLightbox").classList.remove("open");
    document.body.style.overflow = "";
  }

  function navPurseLB(dir) {
    purseLBIndex = (purseLBIndex + dir + purseCollection.length) % purseCollection.length;
    updatePurseLB();
  }

  function updatePurseLB() {
    const p = purseCollection[purseLBIndex];
    document.getElementById("purseLBImg").src = p.img;
    document.getElementById("purseLBImg").alt = "Purse " + (purseLBIndex + 1);
    document.getElementById("purseLBCaption").textContent = p.brand ? (p.brand + (p.caption ? " \u2022 " + p.caption : "")) : "";
    document.getElementById("purseLBCounter").textContent = (purseLBIndex + 1) + " / " + purseCollection.length;
  }

  // Swipe support for lightbox
  (function() {
    const lb = document.getElementById("purseLightbox");
    let sx = 0;
    lb.addEventListener("touchstart", e => { sx = e.touches[0].clientX; });
    lb.addEventListener("touchend", e => {
      const dx = e.changedTouches[0].clientX - sx;
      if (Math.abs(dx) > 50) navPurseLB(dx < 0 ? 1 : -1);
    });
    // Close on clicking background
    lb.addEventListener("click", e => {
      if (e.target === lb) closePurseLB();
    });
    // Keyboard nav
    document.addEventListener("keydown", e => {
      if (!lb.classList.contains("open")) return;
      if (e.key === "Escape") closePurseLB();
      if (e.key === "ArrowLeft") navPurseLB(-1);
      if (e.key === "ArrowRight") navPurseLB(1);
    });
  })();

  renderPurseGrid();

  // ── Service Worker ──
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/static/sw.js");
  }
</script>
</body>
</html>
